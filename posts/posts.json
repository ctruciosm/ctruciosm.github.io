[
  {
    "path": "posts/2025-06-22-paralelizao-no-r-uso-do-future-e-ferramentas-associadas/",
    "title": "Paraleliza√ß√£o no R: Uso do _future_ e ferramentas associadas",
    "description": "Este post aborda a paraleliza√ß√£o como uma estrat√©gia para reduzir o tempo de execu√ß√£o de scripts, permitindo o uso eficiente de m√∫ltiplos n√∫cleos ou m√°quinas. S√£o apresentadas diferentes formas de distribui√ß√£o de tarefas, como execu√ß√£o sequencial, sess√µes independentes e clusters. Al√©m disso, √© discutido como identificar gargalos de processamento por meio de medi√ß√µes e testar alternativas para otimizar o c√≥digo.",
    "author": [
      {
        "name": "Jo√£o Victor Siqueira Rodrigues",
        "url": "https://jsicas.github.io"
      },
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2025-06-22",
    "categories": [
      "R"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nParaleliza√ß√£o\nO pacote future\nO Pacote furrr\nO Pacote doFuture\nO Pacote future.apply\n\nExemplos Adicionais\nExemplo 1: slow_sqrt\nExemplo 2: N√∫meros Aleat√≥rios\n\nEfici√™ncia de C√≥digo\nProfiler\nBenchmark\n\nComent√°rios Finais\n\n\nIntrodu√ß√£o\n√â bem sabido por estat√≠sticos, econometristas, cientistas e analistas de dados que, tanto R quanto Python n√£o s√£o linguagens particularmente r√°pidas. Assim, otimizar o desempenho dos c√≥digos torna-se uma parte essencial da rotina de quem trabalha com estas linguagens. Neste post, focaremos na linguagem R e no uso de recursos para paraleliza√ß√£o.\n\nPara quem busca desempenho e praticidade, uma linguagem bastante promissora √© Julia. Uma excelente iniciativa para come√ßar a aprender essa linguagem √© o projeto ‚ÄúDo Zero ao Julia‚Äù, que oferece recursos introdut√≥rios em portugu√™s.\n\nOutro caminho para otimizar o desempenho, al√©m da j√° famosa vetoriza√ß√£o, √© atrav√©s do C++, cuja integra√ß√£o com o R pode ser realizada utilizando o pacote Rcpp.\n\nA computa√ß√£o paralela √© uma t√©cnica que divide um grande problema em pequenas tarefas, as quais s√£o resolvidas de forma descentralizada podendo ser processadas em v√°rios n√∫cleos de um computador ou entre computadores, normalmente, sendo mais r√°pido do que processar as tarefas de forma sequencial (Flinders e Smalley 2024). A computa√ß√£o paralela √© resposta a uma busca por maior velocidade de execu√ß√£o dos scripts, motivada pelo interesse em aumentar a efici√™ncia do c√≥digo em uma era em que modelos cada vez mais complexos s√£o propostos na literatura.\nEste post apresenta as algumas das principais formas de paralelizar fun√ß√µes no R, al√©m de mostrar como identificar gargalos de processamento e testar alternativas para melhorar a efici√™ncia do c√≥digo.\nParaleliza√ß√£o\n\nPor padr√£o, o R utiliza apenas um n√∫cleo do computador para processar suas tarefas. Paraleliza√ß√£o permite a utiliza√ß√£o de m√∫ltiplos n√∫cleos, diminuindo assim o tempo de processamento.\n\nA Figura 1 apresenta a ideia de como ocorre a paraleliza√ß√£o de processos. Note que, ao utilzarmos processamento em paralelo, existe um tempo chamado de overhead que n√£o estava presente no processamento sequencial. Overhead refere-se ao tempo necess√°rio para coordenar e gerenciar tarefas tais como a comunica√ß√£o entre os n√∫cleos, divis√£o e agrega√ß√£o de tarefas, gerenciamento de mem√≥ria, entre outros.\n\n\n\nFigure 1: Conceito da paraleliza√ß√£o\n\n\n\nA forma apresentada de paraleliza√ß√£o no post abordar√° 3 dos principais pacotes que utilizam o framework do pacote future, sendo eles os pacotes furrr, doFuture e future.apply. √â importante mencionar que, al√©m dos pacotes aqui apresentados, existem outros que tamb√©m podem ser utilizados.\nO pacote future\n\n\nO pacote future, parte do ecossistema futureverse, √© um framework que unifica e simplifica a paraleliza√ß√£o no R. Para isso, ele apresenta uma abstra√ß√£o do conceito de atribui√ß√£o, permitindo o c√°lculo de valores de forma ass√≠ncrona (futura) e resolvidos via futures. Existem 4 planos para resolver um future:\nsequential: resolve futures sequencialmente na sess√£o em utiliza√ß√£o do R, sendo a forma padr√£o de funcionamento do R;\nmultisession: resolve futures de forma ass√≠ncrona e paralelizada gerando, em segundo plano, novas sess√µes independentes do R que se comunicam com o processo principal;\nmulticore: resolve futures de forma ass√≠ncrona e paralelizada gerando forked R processes que rodam em segundo plano. N√£o suportado em sistemas Windows;\ncluster: resolve futures de forma ass√≠ncrona e paralelizada em sess√µes independentes do R, normalmente utilizado para duas ou mais m√°quinas.\nAdemais, al√©m de selecionar o plano, tamb√©m √© necess√°rio escolher a quantidade de n√∫cleos (workers) a serem utilizados, configura√ß√µes definidas por meio da fun√ß√£o plan().\n\nPor exemplo, o comando plan(multisession, workers = 3) configura o plano como multisession e define a utiliza√ß√£o de 3 workers.\n\nAl√©m da fun√ß√£o plan(), as seguintes fun√ß√µes s√£o bastante √∫teis quando o interesse √© paralelizar\nplan(): define a estrat√©gia a ser utilizada, al√©m de, ao ser utilizada sem argumentos, retorna a estrat√©gia atual;\navailableCores(): retorna a quantidade de n√∫cleos que a m√°quina tem;\nnbrOfWorkers(): retorna a quantidade de workers definidos no comando plan();\nnbrOfFreeWorkers(): retorna a quantidade de workers dispon√≠veis, isto √©, os que n√£o est√£o executando nenhuma tarefa.\nPor exemplo, a seguir s√£o apresentadas as configura√ß√µes sem altera√ß√£o do n√∫mero de workers, de um dos autores no momento de escrever este post:\n\n\nplan()\n\nsequential:\n- args: function (..., envir = parent.frame(), workers = \"<NULL>\")\n- tweaked: FALSE\n- call: NULL\n\navailableCores()\n\nsystem \n    12 \n\nnbrOfWorkers()\n\n[1] 1\n\nnbrOfFreeWorkers()\n\n[1] 1\n\nO Pacote furrr\n\n\nO pacote furrr busca combinar os comandos e ferramentas de programa√ß√£o funcional do pacote purrr com o processamento em paralelo do future. Essa integra√ß√£o possibilita a execu√ß√£o paralela de fun√ß√µes de mapeamento com poucas altera√ß√µes no c√≥digo, sendo necess√°rio acrescentar o prefixo future_ √†s fun√ß√µes do purrr. Por exemplo, a vers√£o paralela da fun√ß√£o map() √© a future_map(), a vers√£o paralela da fun√ß√£o imap() √© a future_imap(), e assim por diante.\n\nA seguir, apresentamos um exemplo para ilustrar como utilizar a fun√ß√£o future_map_dbl() para aplicar a fun√ß√£o log() nos elementos de um vetor utilizando 2 workers:\n\n\nlibrary(furrr)\nplan(multisession, workers = 2)  # paralelizar utilizando 2 n√∫cleos\n\nvet <- c(2, exp(1), 10, 20)  # vetor para teste\nfuture_map_dbl(vet, log)\n\n[1] 0.6931472 1.0000000 2.3025851 2.9957323\n\nNa pr√°tica, √© comum o uso de fun√ß√µes mais complexas, as quais poder√£o ser incluidas atrav√©s de duas formas: (a) por meio de fun√ß√µes an√¥nimas, criadas a partir de function(x) {...} (ou \\(x) {...}, para vers√µes superiores ao R 4.1.0) e (b) por medio de uma forma exclusiva do furrr. Para ilustrar isto, veja o exemplo a seguir:\n\n\n# forma 1\nf1 <- future_map(vet, \\(i) {\n  c('log' = log(i), 'quadrado' = i^2)\n})\n\n# forma 2 (exclusiva do furrr)\nf2 <- future_map(vet, ~ c('log' = log(.x), 'quadrado' = .x^2))\n\n# resultado\nidentical(f1, f2)  # TRUE\n\n[1] TRUE\n\nf1  \n\n[[1]]\n      log  quadrado \n0.6931472 4.0000000 \n\n[[2]]\n     log quadrado \n1.000000 7.389056 \n\n[[3]]\n       log   quadrado \n  2.302585 100.000000 \n\n[[4]]\n       log   quadrado \n  2.995732 400.000000 \n\nO Pacote doFuture\nO pacote doFuture √© outra alternativa para realizar a paraleliza√ß√£o de processos. Ele pode ser utilizado de duas formas: a primeira, mais recomendada, √© atrav√©s do operador %dofuture%, enquanto a segunda, menos recomendada, √© atrav√©s do operador %dopar%.\n\nA seguir, ser√° utilizado o pacote doFuture para aplicar a fun√ß√£o \\(log()\\) nos elementos de um vetor utilizando 2 n√∫cleos e retornar um vetor como sa√≠da.\n\n\nlibrary(doFuture)\nplan(multisession, workers = 2)  # paralelizar utilizando 2 n√∫cleos\n\nvet <- c(2, exp(1), 10, 20)  # vetor para teste\nforeach(i = vet, .combine = c) %dofuture% {\n  log(i)\n}\n\n[1] 0.6931472 1.0000000 2.3025851 2.9957323\n\nVale ressaltar que a sa√≠da padr√£o do foreach() √© em formato de lista. Contudo, √© poss√≠vel configur√°-la por meio do argumento .combine, que neste caso foi ajustada para ter um vetor como resultado. Al√©m disso, destaca-se que o foreach() N√ÉO √© um um for-loop, para mais detalhes, veja (Bengtsson 2022, Ap√™ndice 8.8).\nO Pacote future.apply\nO pacote future.apply estende as fun√ß√µes da base do R que aplicam opera√ß√µes √† vetores, matrizes e listas, permitindo a execu√ß√£o de forma paralela com o suporte do framework do future. Este pacote fornece vers√µes paraleliz√°veis de fun√ß√µes da fam√≠lia apply() presente na base do R, bastando adicionar o prefixo future_.\n\nA seguir, est√° apresentado como utilizar o pacote future.apply para aplicar a fun√ß√£o \\(log()\\) nos elementos de um vetor utilizando 2 n√∫cleos:\n\n\nlibrary(future.apply)\nplan(multisession, workers = 2)  # paralelizar utilizando 2 n√∫cleos\n\nvet <- c(2, exp(1), 10, 20)  # vetor para teste\nfuture_sapply(vet, log)\n\n[1] 0.6931472 1.0000000 2.3025851 2.9957323\n\nAl√©m do future_sapply(), temos tamb√©m o future_apply() e o future_lapply().\nExemplos Adicionais\nNesta section dois exemplos adicionais ser√£o abordados, o primeiro, relativo √† compara√ß√£o do tempo de execu√ß√£o com e sem paraleliza√ß√£o considerando os pacotes apresentados, enquanto o segundo discutir√° brevemente a gera√ß√£o de n√∫meros aleat√≥rios e cuidados necess√°rios ao utilizar em conjunto com a computa√ß√£o paralela.\nExemplo 1: slow_sqrt\nSer√° aplicado a fun√ß√£o slow_sqrt(), a qual espera 1 segundo e calcula a raiz quadrada do valor de entrada. Al√©m disso, ser√° apresentado o tempo de execu√ß√£o para aplicar essa fun√ß√£o em cada elemento de um vetor de tamanho 60 com e sem paraleliza√ß√£o.\nPrimeiro ser√° feito o setup necess√°rio:\n\n\nlibrary(future)\n\nplan(multisession, workers = 5)  # paralelizar utilizando 5 n√∫cleos\n# fun√ß√£o slow_sqrt\nslow_sqrt <- function(x) {\n  Sys.sleep(1)  # simula 1 segundo de processamento\n  sqrt(x)\n}\n\n# execu√ß√£o sem paraleliza√ß√£o\nvet <- 1:60  # vetor para teste\n\n\nA seguir, a compara√ß√£o utilizando processamento sequencual e as vers√µes em paralelo\n\n\nmicrobenchmark(M1 = lapply(vet, slow_sqrt), \n               M2 = future_map(vet, slow_sqrt),\n               M3 = foreach(i = vet) %dofuture% {\n                      slow_sqrt(i)\n                    },\n               M4 = future_lapply(vet, slow_sqrt), times = 10)\n\nUnit: seconds\n expr      min       lq     mean   median       uq      max neval\n   M1 59.25603 59.26126 59.31608 59.26598 59.40455 59.48470    10\n   M2 12.01358 12.01692 12.15005 12.02559 12.05385 13.23094    10\n   M3 12.00944 12.02402 12.03647 12.02777 12.06402 12.06695    10\n   M4 12.00339 12.01313 12.02976 12.01728 12.05871 12.06682    10\n\nExemplo 2: N√∫meros Aleat√≥rios\nConsidere as vari√°veis aleat√≥rias \\(X_1 \\sim \\mathcal{N}(0,1)\\), \\(X_2 \\sim \\mathcal{N}(10, 5)\\) e \\(X_3 \\sim \\mathcal{N}(50, 8)\\). Dever√° ser gerado uma amostra com 1000 observa√ß√µes para cada vari√°vel aleat√≥ria apresentada e calculado o m√≠nimo, m√©dia, vari√¢ncia e m√°ximo utilizando \\(4\\) n√∫cleos considerando a seed 123.\nPrimeiro ser√° feito o setup necess√°rio:\n\n\nplan(multisession, workers = 4)  # paralelizar utilizando 4 n√∫cleos\n\n# execu√ß√£o sem paraleliza√ß√£o\nmu <- c(0, 10, 50)\nsigma <- c(1, 5, 8)\n\nset.seed(123)\nlapply(1:3, \\(i) {\n  amostra <- rnorm(1000, mu[i], sigma[i])  # gerando amostra\n  c('min'=min(amostra), 'media'=mean(amostra), 'var'=var(amostra), 'max'=max(amostra))\n})\n\n[[1]]\n        min       media         var         max \n-2.80977468  0.01612787  0.98345893  3.24103993 \n\n[[2]]\n      min     media       var       max \n-5.239304 10.212326 25.486049 26.951854 \n\n[[3]]\n     min    media      var      max \n27.21163 49.83910 61.25973 77.36876 \n\n\n\nfurrr\n\n\n# forma 1\nset.seed(123)\nf1 <- future_map(1:3, \\(i) {\n  amostra <- rnorm(1000, mu[i], sigma[i])  # gerando amostra\n  c('min'=min(amostra), 'media'=mean(amostra), 'var'=var(amostra), 'max'=max(amostra))\n}, .options = furrr_options(seed = TRUE))\n\n# forma 2 (exclusiva do furrr)\nset.seed(123)\nf2 <- future_map(1:3, ~ {\n  amostra <- rnorm(1000, mu[.x], sigma[.x])  # gerando amostra\n  c('min'=min(amostra), 'media'=mean(amostra), 'var'=var(amostra), 'max'=max(amostra))\n}, .options = furrr_options(seed = TRUE))\n\n# resultado\nidentical(f1, f2)\n\n[1] TRUE\n\nf1\n\n[[1]]\n        min       media         var         max \n-3.06732143 -0.01880173  1.10208379  3.40602221 \n\n[[2]]\n      min     media       var       max \n-4.215841 10.052563 25.919922 26.973502 \n\n[[3]]\n     min    media      var      max \n26.47221 50.12970 62.78559 73.13110 \n\n\n\ndoFuture\n\n\nset.seed(123)\nforeach(i = 1:3, .options.future = list(seed = TRUE)) %dofuture% {\n  amostra <- rnorm(1000, mu[i], sigma[i])  # gerando amostra\n  c('min'=min(amostra), 'media'=mean(amostra), 'var'=var(amostra), 'max'=max(amostra))\n}\n\n[[1]]\n        min       media         var         max \n-3.06732143 -0.01880173  1.10208379  3.40602221 \n\n[[2]]\n      min     media       var       max \n-4.215841 10.052563 25.919922 26.973502 \n\n[[3]]\n     min    media      var      max \n26.47221 50.12970 62.78559 73.13110 \n\n\n\nfuture.apply\n\n\nset.seed(123)\nfuture_lapply(1:3, \\(i) {\n  amostra <- rnorm(1000, mu[i], sigma[i])  # gerando amostra\n  c('min'=min(amostra), 'media'=mean(amostra), 'var'=var(amostra), 'max'=max(amostra))\n}, future.seed = TRUE)\n\n[[1]]\n        min       media         var         max \n-3.06732143 -0.01880173  1.10208379  3.40602221 \n\n[[2]]\n      min     media       var       max \n-4.215841 10.052563 25.919922 26.973502 \n\n[[3]]\n     min    media      var      max \n26.47221 50.12970 62.78559 73.13110 \n\n\n\nVeja que o resultado utilizando a paraleliza√ß√£o diverge do que foi encontrado ao n√£o utiliz√°-la. Al√©m disso, note que h√° um argumento referende √† seed em cada fun√ß√£o dos pacotes apresentados, por exemplo, para o pacote furrr √© utilizado o argumento .options = furrr_options(seed = TRUE). Estes argumentos s√£o respons√°veis por manter a reprodutibilidade na gera√ß√£o de n√∫meros pseudo-aleat√≥rios atrav√©s do gerador L‚ÄôEcuyer-CMRG (utilizado pelo future), j√° que o Mersenne-Twister (gerador padr√£o do R) n√£o foi idealizado para trabalhar com paraleliza√ß√£o, podendo gerar n√∫meros correlacionados entre os workers, causando vi√©s e conclus√µes equivocadas.\nAssim, como os geradores s√£o diferentes, o resultado n√£o √© o mesmo, contudo, ambos s√£o v√°lidos, isto √©, todos s√£o amostras das respectivas normais apresentadas.\nEfici√™ncia de C√≥digo\nA busca por solu√ß√µes que diminuem o tempo de processamento computacional (como a computa√ß√£o paralela) vem acompanhadas da preocupa√ß√£o com a sua efici√™ncia. Isto, pois ao se escrever um c√≥digo mais eficiente, o tempo de execu√ß√£o tende a diminuir. No entanto, nem sempre vale a pena investir tempo na otimiza√ß√£o prematura do c√≥digo. Antes disso, √© fundamental avaliar cuidadosamente se esse esfor√ßo √© realmente necess√°rio (Baldauf 2023):\nQuanto tempo √© salvo pela otimiza√ß√£o?\nQual a frequ√™ncia que este c√≥digo √© executado?\nQuanto tempo ser√° necess√°rios para otimizar o c√≥digo?\nAassumindo que √© necess√°ria a otimiza√ß√£o no c√≥digo, torna-se importante detectar quais as linhas que mais consomem tempo. Para isso, ferramentas bastantes √∫teis s√£o os pacotes profvis para detec√ß√£o do gargalo no processamento e microbenchmark para testar tempo de processamento de diversas alternativas, como realizado no exemplo 1.\nImportante:  algumas boas pr√°ticas que podem ajudar a reduzir o tempo de processamento (Baldauf 2023):\nQuando necess√°rio, armazenar resultados intermedi√°rios constatemente utilizados para evitar o rec√°lculo;\nPreferir vetorizar o c√≥digo e substituir for-loops por fun√ß√µes vetorizadas;\nN√£o paralelizar processos muito simples devido ao overhead;\nEvitar manipular objetos grandes na paraleliza√ß√£o.\nProfiler\nPara identificar as partes cr√≠ticas do c√≥digo, isto √©, o gargalo do processamento pode-se utilizar o pacote profvis, o qual examina o tempo gasto em cada fun√ß√£o de determinada parte do script. Seu acesso se d√° por Profile > Start Profiling (e Profile > Stop Profiling para finalizar) na barra de ferramentas do Rstudio ou atrav√©s da fun√ß√£o profvis().\n\nVeja um exemplo abaixo (adaptado de Wickham et al. (2024)):\n\n\n\n\n\n\n\n\n\n\n\nlibrary(profvis)\n\n# fun√ß√µes\nh <- function() {\n  pause(0.1)\n}\n\ng <- function() {\n  pause(0.1)\n  h()\n}\n\nf <- function() {\n  pause(0.1)\n  g()\n  h()\n}\n\n# profiler\nprofvis({\n  f()\n  g()\n})\n\n\n\n\nSua an√°lise est√° dividida em duas abas, a primeira, flame graph, √© apresentado o tempo e mem√≥ria gastos em cada linha de c√≥digo em conjunto com uma timeline das fun√ß√µes utilizadas e, a segunda, Data, apresenta o tempo gasto em cada fun√ß√£o.\nBenchmark\nPor √∫ltimo, o mesmo c√≥digo pode ser escrito de v√°rias formas diferentes, sendo necess√°rio determinar qual delas √© a mais r√°pida. Para isso existe o pacote microbenchmark, o qual auxilia na compara√ß√£o entre as vers√µes do mesmo c√≥digo de forma sistematizada.\nConsidere comparar 3 fun√ß√µes diferentes cujo objetivo √© calcular a soma de um vetor aplicando o logar√≠timo em cada elemento. A primeira, utiliza fun√ß√µes vetorizadas, a segunda e a terceira aplicam os comandos elemento √† elemento, contudo, uma j√° aloca a mem√≥ria necess√°ria criando o vetor x_log do seu tamanho final, o que √© mais eficiente.\n\n\nlibrary(microbenchmark)\n\n# fun√ß√µes\nf1 <- function(x) {  # utilizando fun√ß√µes vetorizadas\n  x_log <- log(x)\n  sum(x_log)\n}\n\nf2 <- function(x) {  # criando vetor do tamanho final (pr√©-alocando mem√≥ria)\n  x_log <- vector(mode = 'numeric', length = length(x))  # tamanho final\n  for (i in 1:length(x)) {\n    x_log[i] <- log(x[i])\n  }\n  sum(x_log)\n}\n\nf3 <- function(x) {  # utilizando o comando append() (ineficiente)\n  x_log <- vector(mode = 'numeric', length = 0)  # tamanho 0\n  for (i in x) {\n    x_log <- append(x_log, log(i))\n  }\n  sum(x_log)\n}\n\n# vetor para teste \nvet <- sample(1:10, size = 3500, replace = TRUE)\n\n# benchmark\ncomp <- microbenchmark(\n  'forma 1' = f1(vet),\n  'forma 2' = f2(vet),\n  'forma 3' = f3(vet)\n)\n\n# resultado\ncomp  \n\nUnit: microseconds\n    expr       min        lq        mean     median         uq\n forma 1    23.452    25.051    36.90041    25.6660    27.3265\n forma 2   177.325   182.081   210.01061   184.3975   187.7800\n forma 3 15469.874 18693.376 19634.10378 19021.0890 19515.1390\n       max neval\n  1087.443   100\n  2686.484   100\n 76993.982   100\n\n# plot do resultado\nlibrary(ggplot2)\nautoplot(comp)\n\n\n\nEnt√£o, veja que a forma 1, isto √©, a fun√ß√£o f1(), √© a mais eficiente (resultado esperado, afinal fun√ß√µes vetorizadas no R s√£o mais eficientes que for-loops). Al√©m disso, veja que a forma 2 se sobressai referente √† forma 3, haja vista que o vetor para armazenar o resultado x_log j√° √© criado com o seu tamanho final, enquanto que a forma 3 fica acrescentando ao final do vetor (na verdade o R faz uma c√≥pia do objeto e faz o acr√©scimo do novo valor, logo, quanto maior for o objeto pior ser√° o desempenho dessa proposta).\nComent√°rios Finais\nExiste a alternativa de executar c√≥digo como um background job. Para fazer isso no Rstudio basta buscar a aba de background job (Figura 2), selecionar o script e o diret√≥rio de trabalho e iniciar. Com isso, o script ser√° executado em uma nova sess√£o, deixando o terminal dispon√≠vel para utiliza√ß√£o mesmo durante sua execu√ß√£o.\n\n\n\nFigure 2: Background jobs no Rstudio\n\n\n\nUma estrat√©gia interessante √© escrever parte do c√≥digo em C++ (atrav√©s do pacote Rcpp) e paralelizar com, por exemplo, future_apply() (que √© uma das formas mais f√°ceis aqui apresentadas). Infelizmente, as tentativas previas realizadas por um dos autores n√£o foram satisfat√≥rias. Uma solu√ß√£o foi utilizar o fun√ß√£o mclapply() do pacote parallel.\nA maior parte deste post foi escrita pelo primeiro autor, Jo√£o Victor Siqueira Rodrigues, a pedido do segundo autor. Este √∫ltimo realizou pequenas modifica√ß√µes no texto original e acrescentou pequenos coment√°rios. O Segundo autor agradece a Jo√£o Victor pela disponibilidade e colabora√ß√£o na elabora√ß√£o de um conte√∫do que, certamente, ser√° √∫til para seus colegas.\nHappy Coding!\n\n\n\nBaldauf, Selina. 2023. Efficient R Scientific workflows: Tools and Tips. GitHub Pages. https://selinazitrone.github.io/tools_and_tips/slides/2023_11_16_efficient_r.html#/title-slide.\n\n\nBengtsson, Henrik. 2022. Future Framework: Parallel and Distributed Processing in R. GitHub Pages. https://henrikbengtsson.github.io/future-tutorial-user2022/appendix.html#appendix-foreach-is-not-a-for-loop.\n\n\nFlinders, Mesh, e Ian Smalley. 2024. What is parallel computing? IBM. https://www.ibm.com/think/topics/parallel-computing.\n\n\nWickham, Hadley, Winston Chang, Javier Luraschi, e Timothy Mastny. 2024. profvis: Interactive Visualizations for Profiling R Code. https://profvis.r-lib.org.\n\n\n\n\n",
    "preview": "posts/2025-06-22-paralelizao-no-r-uso-do-future-e-ferramentas-associadas/figuras/conceito_paralelizacao.png",
    "last_modified": "2025-06-22T23:37:36+02:00",
    "input_file": {},
    "preview_width": 1787,
    "preview_height": 1050
  },
  {
    "path": "posts/2025-06-05-economatica/",
    "title": "Economatica",
    "description": "Como acessar ao Economatica no IMECC?",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2025-06-05",
    "categories": [
      "Datasets"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nComputadores liberados\nAcesso\nBoas pr√°ticas\n\nIntrodu√ß√£o\nComo muitos de voc√™s sabem, trabalho com s√©ries temporais financeiras, com √™nfase em aloca√ß√£o de carteiras e na modelagem e previs√£o de medidas de risco (volatilidade, VaR, ES, etc), nos contextos univariado, multivariado e de alta dimens√£o.\nDurante anos, utilizei dados do Yahoo Finance em minhas pesquisas. No entanto, recentemente percebi que esses dados deixaram de ser confi√°veis. Em particular, encontrei casos em que os pre√ßos de abertura ou fechamento estavam fora do intervalo formado pelos pre√ßos m√≠nimo e m√°ximo (o que obviamente, n√£o faz sentido nenhum).\nMotivado por essa limita√ß√£o, pela necessidade de dados confi√°veis para o desenvolvimento dos meus projetos de pesquisa (obrigado √† FAPESP: 2022/09122-0 e ao FAEPEX: PIND 2525/23 pelo suporte financeiro) e tamb√©m pela alta demanda de alunos e professores nas √°reas de s√©ries temporais, econometria e finan√ßas, iniciei, junto aos professores Mauricio Zevallos e Luiz Hotta, com apoio do IMECC e do BIMECC, um pedido de aquisi√ß√£o de licen√ßas do Economatica para o IMECC.\nO pedido foi aprovado, e desde outubro de 2024, a comunidade do IMECC passou a ter acesso a essa base de dados profissional e confi√°vel.\nComputadores liberados\nOs acessos s√£o liberados por IP e atualmente os computadores disnpon√≠veis no Laborat√≥rio de S√©ries Temporais, Econometria e Finan√ßas do IMECC (CAREFS), bem como algusn computadores da Biblioteca do IMECC tem os IPs liberados e os usu√°rios podem utilizar os dados nas suas pesquisas, trabalhos acad√™micos ou mesmo apenas por curiosidade.\nAcesso\nO acesso √† plataforma Economatica √© bastante simples. A seguir, apresento um passo a passo detalhado:\nRequisito essencial: voc√™ deve utilizar um computador com IP autorizado.\nPara os usu√°rios do CAREFS, qualquer computador com conex√£o cabeada √† internet no laborat√≥rio j√° atende a esse requisito.\nPara quem for acessar a partir da biblioteca, √© necess√°rio consultar quais s√£o os computadores liberados para uso.\n\nAcesse o site www.economatica.com/. A seguinte tela ser√° exibida:\n\n\n\n\n\nClique em ‚ÄúLOGIN‚Äù. Em seguida, aparecer√° esta tela:\n\n\n\n\n\nSelecione a op√ß√£o ‚ÄúPlataforma‚Äù e enseguida aparecer√° uma op√ß√£o para fazer login. Abaixo apresento duas poss√≠veis telas que podem aparecer quando clicar em ‚Äúlogin‚Äù\n\n\nTela errada\nTela certa\n\nSe a tela que aparecer for semelhante √† ‚ÄúTela errada‚Äù, significa que o IP do computador n√£o est√° liberado para uso. A ‚ÄúTela certa‚Äù deve s√≥ pedir email e voc√™ pode colocar seu email institucional.\nAp√≥s alguns segundos (ou at√© um par de minutos de carregamento), a janela principal da ferramenta ser√° aberta:\n\n\n\n\n\n\nDepois disso, √© s√≥ aproveitar todos os benf√≠cios que Economatica pode oferecer. No canal oficial no YouTube da Economatica, h√° diversos tutoriais dispon√≠veis para te ajudar a aprender a utilizar a plataforma da melhor forma poss√≠vel..\n\nEnjoy!\nBoas pr√°ticas\nTente salvar os arquivos seguindo o padr√£o: username_mercado_tipo_frequencia. Por exemplo, se voc√™ estiver montando uma base com os retornos di√°rios das a√ß√µes que comp√µem o √≠ndice IBRx, o nome do arquivo poderia ser ctrucios_ibrx_retornos_diarios (dessa forma, outros usu√°rios buscando os mesmos dados poder√£o utilizar)\nO arquivo, assim que for aberto, atualizar√° a base com os dados mais recentes, bastando apenas salvar o arquivo no computador.\nSe for utilizar um arquivo salvo de outro usu√°rio, apenas abra o arquivo e baixe os dados (mas n√£o altere nenhum par√¢metro na constru√ß√£o na base)!.\n\n\n\n",
    "preview": "posts/2025-06-05-economatica/economatica_01.png",
    "last_modified": "2025-06-06T19:32:22+02:00",
    "input_file": {},
    "preview_width": 2722,
    "preview_height": 974
  },
  {
    "path": "posts/2025-02-17-book-review-hands-on-time-series-analysis-with-r/",
    "title": "Book Review: Hands-On Time Series Analysis with R",
    "description": "Minhas impress√µes do livro \"Hands-On Time Series Analysis with R\" do Rami Krispin.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2025-02-17",
    "categories": [
      "Book Review",
      "R",
      "rstats"
    ],
    "contents": "\n\nContents\nOverview do livro\nComent√°rios gerais\nPr√≥s\nContras\n\nConclus√£o\nB√¥nus\n\n\nOverview do livro\n\n\n\n\n\nNo 2025.1 ministrarei S√©ries Temporais para os alunos da gradua√ß√£o em Estat√≠stica do IMECC/UNICAMP de novo. √â a segunda vez que ministrarei a disciplina e, tentando trazer um novo olhar para ela, resolvi ler um livro mais m√£o na massa.\nO autor do livro √© bastante ativo no linkedIn, o que me motivou a ler o livro que, por sinal, √© editado pela Packt, uma editora que tem v√°rios livros do estilo m√£o na massa.\nComent√°rios gerais\nO livro conta com 12 cap√≠tulos curtos, o que facilita bastante o acompanhamento da leitura. Al√©m disso, os c√≥digos fornecidos ao longo do conte√∫do, juntamente com os coment√°rios nas an√°lises explorat√≥rias, s√£o extremamente √∫teis e valiosos para quem trabalha com s√©ries temporais no cotidiano.\nAo contr√°rio da revis√£o de outro livro pr√°tico que fiz h√° algum tempo, gostei muito mais da leitura de Hands-On Time Series Analysis with R do @krispin2019. Embora o livro apresente alguns pequenos erros de digita√ß√£o, eles s√£o facilmente identific√°veis e n√£o comprometem nem a leitura nem a compreens√£o dos conceitos abordados.\nPr√≥s\nO livro disponibiliza os c√≥digos em um reposit√≥rio p√∫blico, o que facilita ainda mais o aprendizado pr√°tico.\nEst√° repleto de coment√°rios valiosos, que refletem a experi√™ncia de quem realmente trabalha na √°rea e sabe utilizar o R de maneira eficaz.\nOs cap√≠tulos s√£o curtos e objetivos, o que facilita terminar a leitura sem interromper o fluxo, perfeito para concluir ‚Äúantes de dormir‚Äù.\nO autor aborda temas abrangentes que, com exce√ß√£o do √∫ltimo cap√≠tulo, est√£o alinhados com a ementa de um curso de s√©ries temporais de n√≠vel gradua√ß√£o.\nUma das boas surpresas do livro √© a introdu√ß√£o ao pacote h2o, uma excelente ferramenta para trabalhar com aprendizado de m√°quina, al√©m de exemplos pr√°ticos de como aplic√°-lo a s√©ries temporais.\nOs primeiros 10 cap√≠tulos s√£o muito bons, abordando os t√≥picos de maneira direta e com coment√°rios pr√°ticos que realmente agregam ao aprendizado.\nContras\nO livro utiliza exclusivamente c√≥digos em R (e eu sou f√£ do R, mas reconhe√ßo que muitos ‚ÄúPythonicos‚Äù podem sentir falta de exemplos em Python).\nA diferen√ßa dos 10 primeiros cap√≠tulos, eu n√£o gostei muito do cap√≠tulo 11 (ARIMA). Ele n√£o √© ruim, mas achei pr√°tico demais para meu gosto. Por exemplo, ele n√£o discute o poss√≠vel problema de cancelamento de raizes em modelo ARMA, um tema que eu considero importante.\nO √∫ltimo cap√≠tulo, que trata de aprendizado de m√°quina, √© mais um case pr√°tico. O autor deixa claro que o objetivo n√£o √© aprofundar-se nos m√©todos de aprendizado de m√°quina, mas sim demonstrar como s√£o aplicados em s√©ries temporais. No entanto, senti falta de mais detalhes, especialmente porque esse √© um tema pouco explorado em livros-texto sobre s√©ries temporais.\nConclus√£o\nDe maneira geral, gostei bastante do livro e acabei utilizando v√°rios dos c√≥digos e coment√°rios presentes nele nas minhas pr√≥prias notas de aula. Inclusive, decidi inclu√≠-lo como refer√™ncia bibliogr√°fica complementar na ementa da disciplina.\nCaso queira saber mais acerca do curso que ministrarei, pode ver a informa√ß√£o aqui.\nB√¥nus\nO Canal Data Scientist Show fez uma entrevista de 1.5 horas ao Rami Krispin (autor do livro), segue o link para os interessados: youtube.com/watch?v=eHSJA_lej4c.\n\n\n\n",
    "preview": "posts/2025-02-17-book-review-hands-on-time-series-analysis-with-r/hotsawr.png",
    "last_modified": "2025-02-18T15:15:41+01:00",
    "input_file": {},
    "preview_width": 810,
    "preview_height": 1000
  },
  {
    "path": "posts/2024-01-28-como-chegar-do-aeroporto-de-guarulhos-at-a-unicamp/",
    "title": "Do GRU at√© a UNICAMP",
    "description": "Um passo a passo de como chegar do aeroporto de Cumbica, em Guarulhos (GRU) at√© a Universidade Estadual de Campinas (UNICAMP) em Campinas.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2024-01-28",
    "categories": [
      "UNICAMP"
    ],
    "contents": "\n\nContents\nChegando no aeroporto\nDo aeroporto at√© Campinas\nDe Campinas at√© a UNICAMP\nPre√ßos\n\nChegando no aeroporto\n\n\n\n\n\nAo chegar no aeroporto de Guarulhos (GRU) voc√™ chegara no Terminal 2\nou no Terminal 3. Viagens nacionais chegam no Terminal 2 enquanto que\nviagens internacionais chegam, geralmente1, no\nTerminal 3.\n√â poss√≠vel se deslocar de um terminal para outro por dentro do\naeroporto (7 min a p√©), mas tamb√©m existem √¥nibus do proprio aeroporto\nque fazem esse percurso e s√£o gratuitos.\nDo aeroporto at√© Campinas\n\n\n\n\n\nExistem v√°rias formas de chegar at√© Campinas, aqui explico algumas\ndelas:\nNo Terminal 2 tem um √¥nibus da Lira, que vai direto para a\nRodovi√°ria de Campinas. Para comprar online basta entrar no site da Lira e colocar:\nOrigem: Aeroporto de Cumbica.\nDestino: Campinas. Existe tamb√©m um guich√© no pr√≥prio Terminal 2 (do\nlado de fora). Pergunte aos seguran√ßas onde que fica o guich√© do Lira.\nQuando comprar suas passagem, n√£o esque√ßa perguntar onde que pega o\n√¥nibus.\n\nNo Terminal 2 ou 3, pegue um Uber at√© o Terminal Rodovi√°rio Tiete\n(Rodovi√°ria de S√£o Paulo) e de l√°, pegue um √¥nibus at√© a Rodovi√°ria de\nCampinas. Se voc√™ fora o campus de Limeira, pode pegar um √¥nibus, tamb√©m\nda Lira, com destino Limeira.\nPegue o √¥nibus\ndo pr√≥prio aeroporto (aquele que √© gratuito) que v√° at√© o Terminal\n1, da√≠ pegue o tr√™m\nat√© a esta√ß√£o Luz e na esta√ß√£o Luz mude para o metro linha azul com\ndestino √† esta√ß√£o Portuguesa-Tiete (que √© no Terminal Rodovi√°rio Tiete),\nn√£o precisa comprar outra passagem, basta fazer baldea√ß√£o. Esta √© a\nop√ß√£o mais barata, mas n√£o recomendo para quem vem com mala.\nSe for pegar o tr√™m, fique atento aos hor√°rios, pois o tr√™m passa de\nhora em hora. Para os interessados, tem esse video aqui\nque mostra como ir do aeroporto de Guarulhos at√© o centro de s√£o\nPaulo.\n\nObserva√ß√£o: o tr√™m expresso aeroporto (que vai do\nGRU at√© a esta√ß√£o Luz) v√° at√© o Terminal Rodovi√°rio Barra funda, mas\neste terminal n√£o √© o Terminal Tiete, s√£o dois terminais diferentes.\n\nDe Campinas at√© a UNICAMP\n\n\n\n\n\nChegando da rodovi√°ria de Campinas, tem duas formas de chegar at√© a\nUNICAMP: 1. Uber (ou algum outro transporte por aplicativo): Taxis em\nCampinas s√£o bem mais caros do que transporte por aplicativo, ent√£o se\ntiver internet, um Uber pode ser a melhor op√ß√£o. J√° se n√£o tiver\ninternet, na saida da Rodovi√°ria (no andar de cima) tem v√°rios taxis\nesperando. 2. √înibus: pode pegar o 332 que v√° at√© o Hospital das\nClinicas (dentro da Universidade) e da√≠ andar ou pegar um Uber at√© seu\ndestino. Pode pegar tamb√©m o 331 que v√° at√© o Terminal de Bar√£o Geraldo\n(Distrito onde fica a UNICAMP).\n\nObserva√ß√£o: Para pegar √¥nibus em Campinas, precisar√°\nprimeiro criar seu cadastro para poder utilizar seu bilhete\n√önico no celular e tamb√©m precisar√° colocar cr√©dito no bilhete\n√önico. Isto apenas √© poss√≠vel se tiver CPF.\n\nPre√ßos\nOs valores aqui s√£o aproximados e em Real:\nServi√ßo\nValor\nUber: Aeroporto >>> Rodovi√°ria\nTiete\nR. $70-$80\n√înibus: Aeroporto >>> Rodovi√°ria\nde Campinas\nR. $ 47.75\n√înibus: Rod. Tiete >>> Rod. de\nCampinas\nR. $ 45\nUber: Rodovi√°ria de Campinas >>>\nUNICAMP\nR. $35 - $50\nTrem: Terminal 1 >>> Rod.\nTiete\nR. $5\nLembre-se que o Uber tem pre√ßo din√¢mico, ent√£o, dependendo do hor√°rio\nqu voc√™ chegar pode pegar bem mais. Eu j√° paguei R.$60, mas tamb√©m j√°\ntive que pagar R.$150 um dia que cheguei de madrugada.\nA passagem de tr√™m voc√™ compra na mesma esta√ß√£o e s√≥ precisa comprar\numa passagem, o pre√ßo √© aprox. 5 reais (mas n√£o sei exatamente o\nvalor).\nSeja que voc√™ esteja vindo para fazer gradua√ß√£o, interc√¢mbio,\nmestrado, doutorado, p√≥s-doutorado, ou mesmo ser professor. Seja\nbem-vindo(a) a uma das melhores universidades do Brasil, da Am√©rica\nLatina e do mundo.\n\nAlgumas viagens internacionais ainda chegam no Terminal\n2‚Ü©Ô∏é\n",
    "preview": "posts/2024-01-28-como-chegar-do-aeroporto-de-guarulhos-at-a-unicamp/gru-airport.jpg",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-12-28-book-review-practical-time-series-analysis-prediction-with-statistics-and-machine-learning/",
    "title": "Book Review: Practical Time Series Analysis--Prediction with Statistics and Machine Learning",
    "description": "Minhas impress√µes do livro \"Practical Time Series Analysis--Prediction with Statistics and Machine Learning\" da Aileen Nielsen",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2022-12-30",
    "categories": [
      "Book Review",
      "R",
      "rstats",
      "Python"
    ],
    "contents": "\n\nContents\nOverview do livro\nComent√°rios gerais\nPr√≥s\nContras\n\nConclus√£o\n\nOverview do livro\n\n\n\n\n\nNo 2023.1 ministraterei S√©ries Temporais para os\nalunos de gradua√ß√£o em Estat√≠stica do IMECC/UNICAMP. Assim,\npensando em como preparar um material atualizado e atraente para os\nalunos, resolvi ler algumas refer√™ncias bibliogr√°ficas diferentes √†s que\nj√° estou acostumado, refer√™ncias n√£o t√£o tradicionais, come√ßando por\nNielsen (2019).\nEscolhi come√ßar com Nielsen (2019)\npor ser um livro moderno, popular entre analistas e cientistas de dados,\nter uma vers√£o em portugu√™s e disponibilizar os c√≥digos do proprio livro\nneste\nreposit√≥rio.\nComent√°rios gerais\nO livro tem 17 cap√≠tulos, a leitura √© f√°cil e r√°pida (a vers√£o em\nportugues tem alguns paragrafos confussos, mas pode ser coisa da\ntradu√ß√£o). Embora a tabela de conteudo do livro seja bem abrangente, em\ngeral eu n√£o gostei muito do livro, mas tem alguns pontos positivos\ninteressante que descrevo a seguir.\nPr√≥s\nO livro fornece os c√≥digos em um reposit√≥rio\np√∫blico, o que torna o aprendizado mais f√°cil.\nTodos os cap√≠tulos tem refer√™ncias para leituras mais avan√ßadas de\nforma que o leitor pode se aprofundar o quanto quiser em cada um dos\nt√≥picos.\nA autora utiliza ambos R e Python,\ntornamdo-se em uma alternativa interessante para todo tipo de\nusu√°rio.\nO cap√≠tulo 1 √© um dos meus favoritos, voc√™ fica bem motivado e com\nvontade de ler os outros cap√≠tulos do livro, bem como aprender mais de\ns√©ries temporais.\nO cap√≠tulo 10 aborda redes neurais, um t√≥pico pouco abordado por\nlivros mais cl√°ssicos (embora a teoria que suporte o uso de redes\nneurais em s√©ries temporais seja bem insipiente ainda), vale a pena a\nleitura.\nO cap√≠tulo 11 discute como avaliar a performance do modelo. Embora\nseja apresentado de forma introdutoria, achei interessante dedicar um\ncap√≠tulo para isso. Al√©m do mais, o leitor interessado pode se\naprofundar mais no assunto lendo outras fontes e mesmo se n√£o quiser se\naprofundar ter√° uma no√ß√£o de como avaliar os modelos.\nContras\nEmbora o livro tenha um conteudo aparentemente bem abrangente, ele\nn√£o aprofunda nos temas o suficiente (principalmente na parte de\nmodelagem) como para termos um conhecimento b√°sico em s√©ries\ntemporais.\nAo terminar o livro, voc√™ n√£o ter√° uma bagagem suficiente para poder\nescolher corretamente qual modelo utilzar (mas sabera como rodar os\nmodelos em R e/ou Python).\nO livro investe muito tempo na prepara√ß√£o dos dados (sendo algumas\ncoisas obvias at√©) e pouco tempo na parte de modelagem (apenas 4\ncap√≠tulos e os temas s√£o abordados de forma bastante introdut√≥ria).\nAlguns cap√≠tulos d√£o detalhe demais acerca dos c√≥digos, detalhes que\napenas lendo o pr√≥prio c√≥digo s√£o f√°ceis de entender.\nO livro mistura conceitos b√°sicos com conceitos mais avan√ßados\n(cadeia de Markov, volatilidade, etc) mas n√£o tenho certeza se algu√©m\niniciante sabera entender os conceitos mais avan√ßados (mesmo que a\nautora explique brevemente os novos conceitos).\nN√£o todos os exemplos est√£o em ambas as linguagens, algumas vezes √©\nutilizado apenas R e outras apenas\nPython.\nConclus√£o\nEu fui atr√°s do livro pensando incluir ele na bibliografia da minha\ndisciplina, mas ap√≥s ter lido ele todo n√£o o incluirei. O livro n√£o\naborda os temas com a profundidade necess√°ria (pelo menos n√£o para\nalunos de estat√≠stica) mas √© uma fonte interessante para ver c√≥digo.\nAcho que o livro pode ser util para um leitor com conhecimento b√°sico\nque queria lembrar alguns conceitos e ter uma no√ß√£o dos avan√ßos em\nMachine Learning, Deep Learning e pre-processamento de\ndados. Por outro lado, um usu√°rio intermedi√°rio ou avan√ßado achara o\nlivro repetitivo.\nCaso queira saber mais acerca do curso que ministrarei, pode ver a\ninforma√ß√£o aqui.\n\n\n\nNielsen, Aileen. 2019. Practical Time Series Analysis: Prediction\nwith Statistics and Machine Learning. O‚ÄôReilly Media.\n\n\n\n\n",
    "preview": "posts/2022-12-28-book-review-practical-time-series-analysis-prediction-with-statistics-and-machine-learning/ptsa.jpg",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-14-book-review-text-mining-with-r/",
    "title": "Book Review: Text Mining with R",
    "description": "Minhas impress√µes do livro \"Text Mining with R: a tidy approach\" da Julia Silge and David Robinson.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2022-03-14",
    "categories": [
      "Book Review",
      "R",
      "rstats",
      "Text Mining",
      "NLP"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nOverview do livro\nSobre os cap√≠tulos do livro\n\nO que mais/menos gostei\nComent√°rios Finais\n\n\nIntrodu√ß√£o\nMinera√ß√£o de texto (ou text mining) e PLN (processamento da linguagem natural) n√£o s√£o minhas linhas de pesquisa, mas a ra√≠z de um dos projetos do grupo de pesquisa BDAQ fiquei ainda mais curioso sobre como analisar texto.\nFoi assim que resolvi ler alguns livros sobre o assunto, sendo o primeiro deles o livro Text Mining with R: a tidy approach de Silge and Robinson (2017), que pode ser livremence acessado aqui e do qual trago algumas pequenas impress√µes para os alunos interessados no assunto.\nOverview do livro\n\n\n\n\n\nO livro possui uma vers√£o impressa e pode ser adquirido aqui, mas os autores gentilmente disponibilizaram a vers√£o online para ser acessada de forma gratuita aqui (sim, eu fui na gratuita!).\nO livro √© uma introdu√ß√£o r√°pida e pr√°tica √† minera√ß√£o de texto, traz v√°rios exemplos que podem ser facilmente reproduzidos atrav√©s do c√≥digo disponibilizado no pr√≥prio livro e apresenta diversos exemplos nos quais minera√ß√£o de texto pode ser utilizada. Isto todo, utilizando o software R e alguns pacotes tais como tidytext, wordcloud, ggraph, entre muitos outros.\nSobre os cap√≠tulos do livro\nO livro possui 9 cap√≠tulos mais um de refer√™ncias bibliogr√°ficas e a leitura √© bastante fluida e r√°pida.\nOs quatro primeiros cap√≠tulos correspondem a conceitos b√°sicos e s√£o fundamentais para todo aquele que queira analisar texto.\nO capitulo 6 apresenta um tema mais avan√ßado mas sem entrar no rigor matem√°tico, apresentando apenas como e em que situa√ß√µes o m√©todo pode ser utilizado. Acredito que os leitores pouco familiarizados com machine learning ou an√°lise multivariada ter√£o maiores dificuldades para entender (pelo menos intuitivamente) como o m√©todo funciona, mas nada que atrapalhe a leitura do cap√≠tulo.\nComo n√£o tudo no R pertence ao mundo tidyverse, o cap√≠tulo 5 apresenta como transitar entre os diferentes formatos utilizados para armazenar dados de texto de forma f√°cil e simples. Isto permite que seja poss√≠vel utilizar diferentes pacotes destinados √† an√°lise de texto sem maiores preocupa√ß√µes.\nOs cap√≠tulos finais (7, 8 e 9) apresentam casos de estudo, onde tudo o visto no livro pode ser aplicado passo a passo em datasets reais.\nO que mais/menos gostei\nO ponto forte do livro √© que ele pode ser lido, compreendido e aplicado ao mesmo tempo atrav√©s dos c√≥digos disponibilizados logo ap√≥s a explica√ß√£o de cada conceito. Isso faz com que ler o livro seja muito mais did√°tico e agrad√°vel.\nO ponto negativo (embora n√£o seja o foco do livro) √© que os lexicos utilizados est√£o em ingl√™s, o que faz com que sejam necess√°rias algumas adapta√ß√µes para poder trabalhar com texto em portugu√™s. Eu tentei contextualizar um pouco isso nesses slides que preparei para os alunos envolvidos no projeto de pesquisa que o Prof.¬†Marcelo Casta√±eda (FACC/UFRJ) coordena.\nComent√°rios Finais\nEm geral, o livro √© muito bom (pr√°tico, direto, did√°tico) e bastante √∫til para come√ßar com an√°lise de texto.\nO objetivo do livro √© aprensentar os conceitos b√°sicos, ent√£o n√£o pense que ap√≥s a leitura o livro ser√° um Guru em minera√ß√£o de texto.\nAlguns outros livros para se aprofundar no assunto s√£o: Supervised Machine Learning for Text Analysis in R (Hvitfeldt and Silge 2021) que est√° disponibilizado livremente aqui e Textual Data Science with R (B√©cue-Bertaut 2019)\n\nSe voc√™ gostar do R assim como eu, os c√≥digos no livro ser√£o muito √∫teis. Contudo, se voc√™ preferir alguma outra linguagem como Python ou Julia, o livro continua sendo √∫til e voc√™ pode focar em entender os conceitos e os exemplos de aplica√ß√£o, bastando apenas como implementar os m√©todos na linguagem de prefer√™ncia (devem existir diversas fontes onde pode encontrar isso.)\n\nHappy Coding!\n\n\n\n\nB√©cue-Bertaut, Monica. 2019. Textual Data Science with r. CRC Press.\n\n\nHvitfeldt, Emil, and Julia Silge. 2021. Supervised Machine Learning for Text Analysis in r. Chapman; Hall/CRC.\n\n\nSilge, Julia, and David Robinson. 2017. Text Mining with r: A Tidy Approach. O‚ÄôReilly Media, Inc.\n\n\n\n\n",
    "preview": "posts/2022-03-14-book-review-text-mining-with-r/tmwR.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 2100,
    "preview_height": 2756
  },
  {
    "path": "posts/2021-12-01-r-como-importar-dados-do-excel/",
    "title": "R: como importar dados do Excel?",
    "description": "No R √© muito comum importar dados em formato .txt ou .csv. Contudo, muitas vezes estamos interessados em importar arquivos salvos em excel (.xls ou .xlsx). Neste post, apresento duas formas de ler dados vindos do Excel.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-12-01",
    "categories": [
      "R",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nO pacote readxl\nO pacote xlsx\n\nIntrodu√ß√£o\nA forma mais f√°cil de importar dados do Excel √© salvando os arquivos como .csv e depois importando esse dataset como usual.\n\n\n\n\n\n\n\n\n\nContudo, fazer isso n√£o sempre √© confort√°vel (e se tiver muitos arquivos pode ser um pouco tedioso). Por isso, existem v√°rias formas de importar os dados em excel, aqui veremos apenas duas formas.\n\nO pacote readxl\nO pacote readxl √© uma √≥tima forma de importar dados em formato .xls ou .xlsx. Se quisermos importar um arquivo .xls utilizamos a fun√ß√£o read_xls(), j√° se o arquivo tem extens√£o .xlsx utilizamos a fun√ß√£o read_xlsx().\n\n\nlibrary(readxl)\narquivo_xls <- read_xls(\"nome_do_arquivo.xls\")\narquivo_xlsx <- read_xlsx(\"nome_do_outro_arquivo.xlsx\")\n\n\n\nSe tivermos um arquivo com v√°rias abas, basta utilizar o argumento sheet (dispon√≠vel em ambas as fun√ß√µes).\nNo seguinte exemplo, utilizaremos o arquivo NotasMAD211.xls, que contem duas abas (uma chamada P1 e outra chamada P2).\n\n\n\n\n\n\n\nlibrary(readxl)\nnotas_p1 <- read_xlsx(\"NotasMAD211.xlsx\", sheet = 1)\nhead(notas_p1)\n\n\n# A tibble: 6 √ó 2\n  ALUNO      Nota\n  <chr>     <dbl>\n1 Carlos      7.1\n2 Jose        7  \n3 Maria       6.6\n4 Jo√£o       10  \n5 Beatriz     9  \n6 Guilherme   7  \n\n\n\n\n\n\n\n\nnotas_p2 <- read_xlsx(\"NotasMAD211.xlsx\", sheet = \"P2\")\nhead(notas_p2)\n\n\n# A tibble: 6 √ó 2\n  ALUNO      Nota\n  <chr>     <dbl>\n1 Carlos      7.1\n2 Jose        9  \n3 Maria      10  \n4 Jo√£o        4  \n5 Beatriz     8.8\n6 Guilherme   9  \n\nO argumento sheet permite especificar ou posi√ß√£o da aba (na ordem em que ela aparece no arquivo) ou o nome da aba que queremos importar (o nome precisa estar entre aspas).\nO pacote xlsx\nAlgumas vezes, os arquivos com os quais trabalhamos est√£o protegidos por senha. Nesses casos, a fun√ß√£o read.xlsx do pacote xlsx nos ajudar√° a importar os dados. read.xlsx funciona de forma parecida com as fun√ß√µes read_xls e read_xlsx.\nVamos supor que o arquivo NotasMAD211.xlsx esteja protegido por uma senha e que a senha seja BatatinhaFrita_123.\n\n\nlibrary(xlsx)\nnotas_p2 <- read.xlsx(\"NotasMAD211.xlsx\", sheetIndex = 2, password = \"BatatinhaFrita_123\")\n\n\n\nPronto! Os dados est√£o importados üÜí.\nObserva√ß√µes\nO argumento sheetIndex da fun√ß√£o read.xlsx permite especificar a ordem da aba que queremos importar. Se quiser especificar o nome da aba, basta usar o argumento sheetName em lugar de sheetIndex.\nCuidado com arquivos de excel com filtros ativos. J√° tive problemas carregando arquivos de excel quando tinha filtros ativos, a solu√ß√£o foi remover os filtros antes de importar o arquivo para o excel.\nHappy Coding!\n\n\n\n",
    "preview": "posts/2021-12-01-r-como-importar-dados-do-excel/ascsv001.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 289,
    "preview_height": 483
  },
  {
    "path": "posts/2021-07-27-criando-relatorios-no-rstudio/",
    "title": "Criando relatorios no Rstudio",
    "description": "Escrever relat√≥rios cient√≠ficos pode ser um trabalho tedioso, mas existem formas que deixam o trabalho um pouco mais prazeroso. Uma delas √© o Rmarkdown, que nos ajuda a escrever relat√≥rios de forma f√°cil e com uma apresenta√ß√£o mais profissional (al√©m de permitir incluir c√≥digo, figuras e tabelas diretamente do R).  Neste post explicarei os primeiros passos para fazer relat√≥rios com o Rstudio.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-07-27",
    "categories": [
      "Rstudio",
      "Rmarkdown",
      "Latex",
      "Relatorios",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nConfigura√ß√£o\nPrimeiros passos\n\n\n\n\nIntrodu√ß√£o\nEscrever relat√≥rios e artigos cient√≠ficos s√£o tarefas que fazem parte da vida de todo pesquisador. Alguns preferem utilizar word, que √© um editor de texto amplamente conhecido. J√° outros, como eu, preferem utilizar que nos permite escrever f√≥rmulas matem√°ticas de forma f√°cil e elegante.\nContudo, essas duas op√ß√µes n√£o s√£o as √∫nicas no mercado. Se voc√™ gostar do R/Rstudio, quer utilizar um formato elegante, quer a flexibilidade de trocar entre pdf e word facilmente e ainda quer facilitar sua vida editando tabelas e gr√°ficos‚Ä¶ voc√™ precisa utilizar o Rmarkdown! üï∫.\nConfigura√ß√£o\nPara poder fazer os relat√≥rios, precisa de configurar o Rstudio primeiro. Se nunca fez isto antes, leia este post aqui\nPrimeiros passos\nUma vez configurado o Rstudio, assista este video onde explico passo a passo como fazer os relat√≥rios (basta fazer clic na imagem).\n\nComo pode ver, a forma de escrever √© muito f√°cil e simples, basta escrever da mesma forma que escrevemos em qulquer editor de texto e incluir alguns pequenos detalhes para aquelas coisas que s√£o um pouco mais complexas.\nRecomendo que imprima e tenha sempre por perto o seguinte Cheat Sheet, que √© um resumo das coisas b√°sicas que precisa saber para fazer seus relat√≥rios. Se precisar de coisas mais avan√ßadas, tem esse outro Cheat Sheet que pode lhe ajudar. Para uma guia completa do Rmarkdown, entre aqui.\n\nEm um pr√≥ximo post explicarei algumas outras coisas (incluir c√≥digo, figuras, tabelas, etc).\n\nHappy Coding!\n\n\n\n",
    "preview": "posts/2021-07-27-criando-relatorios-no-rstudio/rmarkdown.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 400,
    "preview_height": 257
  },
  {
    "path": "posts/2021-07-24-utilizando-o-r-para-ler-tabelas-em-pdf/",
    "title": "Utilizando o R para ler tabelas em PDF",
    "description": "√â poss√≠vel trazer para o R dados/tabelas vindos de um arquivo em PDF?  Neste post eu compartilho minha experi√™ncia com o pacote `tabulizer`, que nos ajudar√° a extrair tabelas em PDF e import√°-las como _datasets_ no R.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-07-24",
    "categories": [
      "Rstudio",
      "Git",
      "GitHub",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nConfigura√ß√£o\nExtraindo a tabela do PDF\nComent√°rios finais\n\n\n\n\nIntrodu√ß√£o\nRecentemente, alguns alun@s me perguntaram se era poss√≠vel importar no R dados vindos de um arquivo PDF. Honestamente, nunca tive a necessidade de fazer isso, mas sabia que certamente existia algum pacote para isso no R.\nPesquisando pela internet encontrei algumas op√ß√µes, entre elas, o pacote tabulizer (Leeper 2018).\nConfigura√ß√£o\nO processo de extra√ß√£o ser√° feito com o pacote tabulizer, que precisa do pacote rJava, que por sua vez, precisa ter o JDK (Java Developer Kit) instalado.\nPara instalar o necess√°rio, siga os seguintes passos:\nInstalar o Java Developer Kit (Link para baixar aqui)\nPara usu√°rios do Mac, digitar no terminal sudo R CMD javareconf (se voc√™ utilizar windos, talvez este post ajude)\nInstalar no R os pacotes rJava, tabulizerjars e tabulizer,\n\n\ninstall.packages(\"rJava\")\ninstall.packages(\"tabulizerjars\")\ninstall.packages(\"tabulizer\")\n\n\n\nExtraindo a tabela do PDF\nAp√≥s a configura√ß√£o, carregamos os pacotes rJava, tabulizerjars e tabulizer no R. Se a configura√ß√£o anterior foi bem sucedida, os pacotes carregar√£o sem nenhum problema.\n\n\nlibrary(rJava)\nlibrary(tabulizerjars)\nlibrary(tabulizer)\n\n\n\nPara extrair as tabelas, utilizaremos a fun√ß√£o extract_tables(). Por padr√£o, esta fun√ß√£o tem o argumento guess = TRUE o que significa que a fun√ß√£o vai adivinhar a localiza√ß√£o da tabela no PDF (mas se quisermos ser mais espec√≠ficos, teremos que mudar alguns dos par√¢metros. Para mais detalhes ver help(extract_tables)).\nA maneira de exemplo, utilizaremos o seguinte PDF e para importar os dados contidos nas tabelas, utilizaremos os seguintes comandos.\n\n\nendereco_arquivo <- \"https://www.math.arizona.edu/~jwatkins/normal-table.pdf\"\ntabelas <- extract_tables(file   = endereco_arquivo, output = \"data.frame\")\n\n\n\nNote que o objeto tabelas √© uma lista com dois elementos, um por cada tabela.\n\n\nclass(tabelas)\n\n\n[1] \"list\"\n\nlength(tabelas)\n\n\n[1] 2\n\nSe quisermos acessar a alguma das tabelas, basta fazer\n\n\nlibrary(dplyr)\nlibrary(purrr)\ntabelas %>% pluck(1) %>% as_tibble()  # Primeira tabela\n\n\n# A tibble: 35 x 11\n       z  X0.00  X0.01  X0.02  X0.03  X0.04  X0.05  X0.06  X0.07\n   <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n 1  -3.4 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003\n 2  -3.3 0.0005 0.0005 0.0005 0.0004 0.0004 0.0004 0.0004 0.0004\n 3  -3.2 0.0007 0.0007 0.0006 0.0006 0.0006 0.0006 0.0006 0.0005\n 4  -3.1 0.001  0.0009 0.0009 0.0009 0.0008 0.0008 0.0008 0.0008\n 5  -3   0.0013 0.0013 0.0013 0.0012 0.0012 0.0011 0.0011 0.0011\n 6  -2.9 0.0019 0.0018 0.0018 0.0017 0.0016 0.0016 0.0015 0.0015\n 7  -2.8 0.0026 0.0025 0.0024 0.0023 0.0023 0.0022 0.0021 0.0021\n 8  -2.7 0.0035 0.0034 0.0033 0.0032 0.0031 0.003  0.0029 0.0028\n 9  -2.6 0.0047 0.0045 0.0044 0.0043 0.0041 0.004  0.0039 0.0038\n10  -2.5 0.0062 0.006  0.0059 0.0057 0.0055 0.0054 0.0052 0.0051\n# ‚Ä¶ with 25 more rows, and 2 more variables: X0.08 <dbl>, X0.09 <dbl>\n\ntabelas %>% pluck(2) %>% as_tibble()  # Segunda tabela\n\n\n# A tibble: 35 x 11\n       z X0.00 X0.01 X0.02 X0.03 X0.04 X0.05 X0.06 X0.07 X0.08 X0.09\n   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1   0   0.5   0.504 0.508 0.512 0.516 0.520 0.524 0.528 0.532 0.536\n 2   0.1 0.540 0.544 0.548 0.552 0.556 0.560 0.564 0.568 0.571 0.575\n 3   0.2 0.579 0.583 0.587 0.591 0.595 0.599 0.603 0.606 0.610 0.614\n 4   0.3 0.618 0.622 0.626 0.629 0.633 0.637 0.641 0.644 0.648 0.652\n 5   0.4 0.655 0.659 0.663 0.666 0.67  0.674 0.677 0.681 0.684 0.688\n 6   0.5 0.692 0.695 0.698 0.702 0.705 0.709 0.712 0.716 0.719 0.722\n 7   0.6 0.726 0.729 0.732 0.736 0.739 0.742 0.745 0.749 0.752 0.755\n 8   0.7 0.758 0.761 0.764 0.767 0.770 0.773 0.776 0.779 0.782 0.785\n 9   0.8 0.788 0.791 0.794 0.797 0.800 0.802 0.805 0.808 0.811 0.813\n10   0.9 0.816 0.819 0.821 0.824 0.826 0.829 0.832 0.834 0.836 0.839\n# ‚Ä¶ with 25 more rows\n\nou equivalentemente (sem utilizar o tidyway)\n\n\ntabelas[[1]]   # Primeira tabela\n\n\n      z  X0.00  X0.01  X0.02  X0.03  X0.04  X0.05  X0.06  X0.07\n1  -3.4 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003\n2  -3.3 0.0005 0.0005 0.0005 0.0004 0.0004 0.0004 0.0004 0.0004\n3  -3.2 0.0007 0.0007 0.0006 0.0006 0.0006 0.0006 0.0006 0.0005\n4  -3.1 0.0010 0.0009 0.0009 0.0009 0.0008 0.0008 0.0008 0.0008\n5  -3.0 0.0013 0.0013 0.0013 0.0012 0.0012 0.0011 0.0011 0.0011\n6  -2.9 0.0019 0.0018 0.0018 0.0017 0.0016 0.0016 0.0015 0.0015\n7  -2.8 0.0026 0.0025 0.0024 0.0023 0.0023 0.0022 0.0021 0.0021\n8  -2.7 0.0035 0.0034 0.0033 0.0032 0.0031 0.0030 0.0029 0.0028\n9  -2.6 0.0047 0.0045 0.0044 0.0043 0.0041 0.0040 0.0039 0.0038\n10 -2.5 0.0062 0.0060 0.0059 0.0057 0.0055 0.0054 0.0052 0.0051\n11 -2.4 0.0082 0.0080 0.0078 0.0075 0.0073 0.0071 0.0069 0.0068\n12 -2.3 0.0107 0.0104 0.0102 0.0099 0.0096 0.0094 0.0091 0.0089\n13 -2.2 0.0139 0.0136 0.0132 0.0129 0.0125 0.0122 0.0119 0.0116\n14 -2.1 0.0179 0.0174 0.0170 0.0166 0.0162 0.0158 0.0154 0.0150\n15 -2.0 0.0228 0.0222 0.0217 0.0212 0.0207 0.0202 0.0197 0.0192\n16 -1.9 0.0287 0.0281 0.0274 0.0268 0.0262 0.0256 0.0250 0.0244\n17 -1.8 0.0359 0.0351 0.0344 0.0336 0.0329 0.0322 0.0314 0.0307\n18 -1.7 0.0446 0.0436 0.0427 0.0418 0.0409 0.0401 0.0392 0.0384\n19 -1.6 0.0548 0.0537 0.0526 0.0516 0.0505 0.0495 0.0485 0.0475\n20 -1.5 0.0668 0.0655 0.0643 0.0630 0.0618 0.0606 0.0594 0.0582\n21 -1.4 0.0808 0.0793 0.0778 0.0764 0.0749 0.0735 0.0721 0.0708\n22 -1.3 0.0968 0.0951 0.0934 0.0918 0.0901 0.0885 0.0869 0.0853\n23 -1.2 0.1151 0.1131 0.1112 0.1093 0.1075 0.1056 0.1038 0.1020\n24 -1.1 0.1357 0.1335 0.1314 0.1292 0.1271 0.1251 0.1230 0.1210\n25 -1.0 0.1587 0.1562 0.1539 0.1515 0.1492 0.1469 0.1446 0.1423\n26 -0.9 0.1841 0.1814 0.1788 0.1762 0.1736 0.1711 0.1685 0.1660\n27 -0.8 0.2119 0.2090 0.2061 0.2033 0.2005 0.1977 0.1949 0.1922\n28 -0.7 0.2420 0.2389 0.2358 0.2327 0.2296 0.2266 0.2236 0.2206\n29 -0.6 0.2743 0.2709 0.2676 0.2643 0.2611 0.2578 0.2546 0.2514\n30 -0.5 0.3085 0.3050 0.3015 0.2981 0.2946 0.2912 0.2877 0.2843\n31 -0.4 0.3446 0.3409 0.3372 0.3336 0.3300 0.3264 0.3228 0.3192\n32 -0.3 0.3821 0.3783 0.3745 0.3707 0.3669 0.3632 0.3594 0.3557\n33 -0.2 0.4207 0.4168 0.4129 0.4090 0.4052 0.4013 0.3974 0.3936\n34 -0.1 0.4602 0.4562 0.4522 0.4483 0.4443 0.4404 0.4364 0.4325\n35  0.0 0.5000 0.4960 0.4920 0.4880 0.4840 0.4801 0.4761 0.4721\n    X0.08  X0.09\n1  0.0003 0.0002\n2  0.0004 0.0003\n3  0.0005 0.0005\n4  0.0007 0.0007\n5  0.0010 0.0010\n6  0.0014 0.0014\n7  0.0020 0.0019\n8  0.0027 0.0026\n9  0.0037 0.0036\n10 0.0049 0.0048\n11 0.0066 0.0064\n12 0.0087 0.0084\n13 0.0113 0.0110\n14 0.0146 0.0143\n15 0.0188 0.0183\n16 0.0239 0.0233\n17 0.0301 0.0294\n18 0.0375 0.0367\n19 0.0465 0.0455\n20 0.0571 0.0559\n21 0.0694 0.0681\n22 0.0838 0.0823\n23 0.1003 0.0985\n24 0.1190 0.1170\n25 0.1401 0.1379\n26 0.1635 0.1611\n27 0.1894 0.1867\n28 0.2177 0.2148\n29 0.2483 0.2451\n30 0.2810 0.2776\n31 0.3156 0.3121\n32 0.3520 0.3483\n33 0.3897 0.3859\n34 0.4286 0.4247\n35 0.4681 0.4641\n\ntabelas[[1]]   # Segunda tabela\n\n\n      z  X0.00  X0.01  X0.02  X0.03  X0.04  X0.05  X0.06  X0.07\n1  -3.4 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003 0.0003\n2  -3.3 0.0005 0.0005 0.0005 0.0004 0.0004 0.0004 0.0004 0.0004\n3  -3.2 0.0007 0.0007 0.0006 0.0006 0.0006 0.0006 0.0006 0.0005\n4  -3.1 0.0010 0.0009 0.0009 0.0009 0.0008 0.0008 0.0008 0.0008\n5  -3.0 0.0013 0.0013 0.0013 0.0012 0.0012 0.0011 0.0011 0.0011\n6  -2.9 0.0019 0.0018 0.0018 0.0017 0.0016 0.0016 0.0015 0.0015\n7  -2.8 0.0026 0.0025 0.0024 0.0023 0.0023 0.0022 0.0021 0.0021\n8  -2.7 0.0035 0.0034 0.0033 0.0032 0.0031 0.0030 0.0029 0.0028\n9  -2.6 0.0047 0.0045 0.0044 0.0043 0.0041 0.0040 0.0039 0.0038\n10 -2.5 0.0062 0.0060 0.0059 0.0057 0.0055 0.0054 0.0052 0.0051\n11 -2.4 0.0082 0.0080 0.0078 0.0075 0.0073 0.0071 0.0069 0.0068\n12 -2.3 0.0107 0.0104 0.0102 0.0099 0.0096 0.0094 0.0091 0.0089\n13 -2.2 0.0139 0.0136 0.0132 0.0129 0.0125 0.0122 0.0119 0.0116\n14 -2.1 0.0179 0.0174 0.0170 0.0166 0.0162 0.0158 0.0154 0.0150\n15 -2.0 0.0228 0.0222 0.0217 0.0212 0.0207 0.0202 0.0197 0.0192\n16 -1.9 0.0287 0.0281 0.0274 0.0268 0.0262 0.0256 0.0250 0.0244\n17 -1.8 0.0359 0.0351 0.0344 0.0336 0.0329 0.0322 0.0314 0.0307\n18 -1.7 0.0446 0.0436 0.0427 0.0418 0.0409 0.0401 0.0392 0.0384\n19 -1.6 0.0548 0.0537 0.0526 0.0516 0.0505 0.0495 0.0485 0.0475\n20 -1.5 0.0668 0.0655 0.0643 0.0630 0.0618 0.0606 0.0594 0.0582\n21 -1.4 0.0808 0.0793 0.0778 0.0764 0.0749 0.0735 0.0721 0.0708\n22 -1.3 0.0968 0.0951 0.0934 0.0918 0.0901 0.0885 0.0869 0.0853\n23 -1.2 0.1151 0.1131 0.1112 0.1093 0.1075 0.1056 0.1038 0.1020\n24 -1.1 0.1357 0.1335 0.1314 0.1292 0.1271 0.1251 0.1230 0.1210\n25 -1.0 0.1587 0.1562 0.1539 0.1515 0.1492 0.1469 0.1446 0.1423\n26 -0.9 0.1841 0.1814 0.1788 0.1762 0.1736 0.1711 0.1685 0.1660\n27 -0.8 0.2119 0.2090 0.2061 0.2033 0.2005 0.1977 0.1949 0.1922\n28 -0.7 0.2420 0.2389 0.2358 0.2327 0.2296 0.2266 0.2236 0.2206\n29 -0.6 0.2743 0.2709 0.2676 0.2643 0.2611 0.2578 0.2546 0.2514\n30 -0.5 0.3085 0.3050 0.3015 0.2981 0.2946 0.2912 0.2877 0.2843\n31 -0.4 0.3446 0.3409 0.3372 0.3336 0.3300 0.3264 0.3228 0.3192\n32 -0.3 0.3821 0.3783 0.3745 0.3707 0.3669 0.3632 0.3594 0.3557\n33 -0.2 0.4207 0.4168 0.4129 0.4090 0.4052 0.4013 0.3974 0.3936\n34 -0.1 0.4602 0.4562 0.4522 0.4483 0.4443 0.4404 0.4364 0.4325\n35  0.0 0.5000 0.4960 0.4920 0.4880 0.4840 0.4801 0.4761 0.4721\n    X0.08  X0.09\n1  0.0003 0.0002\n2  0.0004 0.0003\n3  0.0005 0.0005\n4  0.0007 0.0007\n5  0.0010 0.0010\n6  0.0014 0.0014\n7  0.0020 0.0019\n8  0.0027 0.0026\n9  0.0037 0.0036\n10 0.0049 0.0048\n11 0.0066 0.0064\n12 0.0087 0.0084\n13 0.0113 0.0110\n14 0.0146 0.0143\n15 0.0188 0.0183\n16 0.0239 0.0233\n17 0.0301 0.0294\n18 0.0375 0.0367\n19 0.0465 0.0455\n20 0.0571 0.0559\n21 0.0694 0.0681\n22 0.0838 0.0823\n23 0.1003 0.0985\n24 0.1190 0.1170\n25 0.1401 0.1379\n26 0.1635 0.1611\n27 0.1894 0.1867\n28 0.2177 0.2148\n29 0.2483 0.2451\n30 0.2810 0.2776\n31 0.3156 0.3121\n32 0.3520 0.3483\n33 0.3897 0.3859\n34 0.4286 0.4247\n35 0.4681 0.4641\n\ne pronto!, nossos dados do PDF est√£o agora no R!.\nComent√°rios finais\nSe voc√™ tiver uma vers√£o do JDK mais recente, provavelmemte o Rstudio vai travar quando tentar utilizar a fun√ß√£o extract_tables().\nPara corrigir o problema, basta desinstalar a vers√£o mais recente e instalar a vers√£o 11\nSe n√£o quiser desinstalar a vers√£o mais atual do JDK, instale a vers√£o 11 sem desinstalar a outra vers√£o e no terminal do R escreva\n\n\nSys.setenv(JAVA_HOME='/Library/Java/JavaVirtualMachines/jdk-11.0.12.jdk/Contents/Home')\n\n\n\nem que /Library/Java/JavaVirtualMachines/jdk-11.0.12.jdk √© o endere√ßo onde a vers√£o 11.0.12 foi instalada.\n\nNota: Ainda n√£o testei a fun√ß√£o com outras tabelas, ent√£o n√£o sei que t√£o bem funciona com tabelas mais complexas.\n\nHappy Coding!\n\n\n\nLeeper, Thomas J. 2018. Tabulizer: Bindings for Tabula PDF Table Extractor Library.\n\n\n\n\n",
    "preview": "posts/2021-07-24-utilizando-o-r-para-ler-tabelas-em-pdf/pexels-artem-podrez-6779714.jpg",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-06-18-criar-um-novo-projetorepo-no-rstudiogithub/",
    "title": "Criar um novo projeto/repo no Rstudio/GitHub",
    "description": "Passo a passo para criar um novo projeto no Rstudio e vincul√°-lo ao GitHub.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-06-18",
    "categories": [
      "Rstudio",
      "Git",
      "GitHub",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nPr√©-requisitos.\nCriando um novo projeto.\n\n\n\n\nIntrodu√ß√£o\nNo meu post anterior, falei um pouco de como configurar o Rstudio para ele estar vinculado ao nosso Github. Hoje explicarei como criar um novo projeto no Rstudio e vincul√°-lo ao GitHub (sem precisar clonar um reposit√≥rio existente como vimos no post anterior).\nPr√©-requisitos.\nTer sua conta do Git/GitHub configurada com o Rstudio.\nCriando um novo projeto.\nPara criar um novo projeto:\n\n\nusethis::create_project(\"/Volumes/CTRUCIOS_SD/Research/repo_teste\")\n\n\n\nrepare que /Volumes/CTRUCIOS_SD/Research/ √© o local onde quero criar o novo projeto e repo_teste √© o nome do novo projeto.\nAssim que rodar o c√≥digo acima, aparecer√° algo parecido com:\n\n\n\nLogo ap√≥s, o Rstudio abrir√° outra sess√£o com o novo projeto. Se n√£o abriu, v√° na pasta onde criou o projeto, no meu caso /Volumes/CTRUCIOS_SD/Research/, e encontrar√° uma pasta com o nome repo_teste onde encontrar√° o projeto do Rstudio (arquivo repo_teste.Rproj).\nNessa nova sess√£o do Rstudio, repare que o nome do novo projeto aparece no canto superior direito. (Aqui j√° pode fechar todas as outras sess√µes abertas do Rstudio e ficar apenas com a do nosso novo projeto).\n\n\n\nAgora precisamos vincular esse novo projeto ao Git/GitHub. Primeiro vincularemos o projetoco Git.\n\n\nusethis::use_git() \n\n\n\n\n\n\n\n\n\nUma vez vinculado o projeto ao Git, vinculamos ele ao GitHub.\n\n\nusethis::use_github()\n\n\n\n\n\n\nSe tudo de certo, v√° no teu Github e ter√° o reposit√≥rio l√°.\n\n\n\nPronto! Seu novo projeto foi criado, e vinculado com o Git/GitHub.\nHappy Coding!\n\n\n\n",
    "preview": "posts/2021-06-18-criar-um-novo-projetorepo-no-rstudiogithub/im/original.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 896,
    "preview_height": 896
  },
  {
    "path": "posts/2021-06-12-git-github-e-rstudio/",
    "title": "Git, GitHub e Rstudio",
    "description": "Tutorial de como configurar o Git/GitHub no Rstudio.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-06-12",
    "categories": [
      "Rstudio",
      "rstats",
      "Git",
      "GitHub"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nPr√©-requisitos\nPrimeiros Passos\nIniciando a configura√ß√£o\nVinculando um reposit√≥rio ao Rstudio\nBonus: commit and push\nEDIT:\n\nIntrodu√ß√£o\nSe voc√™ escreve c√≥digo (seja na linguagem que for) sabe que utilizar o Git/GitHub √© muito √∫til. Se voc√™ (assim como eu) gosta de usar o Rstudio, talvez esteja interessado(a) em configurar sua conta do Git no Rstudio.\nEsta configura√ß√£o √© algo que √© feito apenas uma √∫nica vez na vida (ok n√£o na vida, mas uma √∫nica vez por computador) e este tutorial vai te guiar no passo a passo.\nPr√©-requisitos\nAntes de come√ßar, existem algumas coisas que devemos fazer antes (caso ainda n√£o tenha feito):\nInstalar o R (Baixar aqui)\nInstalar o Rstudio (Baixar aqui)\nCriar uma conta no Github (criar conta aqui)\nInstalar o Git (Baixar aqui)\nPrimeiros Passos\nNo Rstudio instalar e carregar o pacote usethis\n\n\ninstall.packages(\"usethis\")\nlibrary(usethis)\n\n\n\nPara configurar sua conta do Git no Rstudio precisar√° de um nome de usu√°rio e do email utilizado na conta do Github.\n\n\nusethis::use_git_config(user.name = \"nome_usuario_aqui\", \n                        user.email = \"email_github_aqui@gmail.com\") \n\n\n\nIniciando a configura√ß√£o\nNo Rstudio escreva\n\n\nusethis::create_github_token()\n\n\n\nisto abrir√° no seu navegador algo mais ou menos assim:\n\n\n\nVoc√™ pode escrever o nome que voc√™ quiser (por exemplo RstudioNotebook, RstudioCasa, etc) mas recomendo que seja um nome que lhe ajude a lembrar para que esse token √© utilizado. Eu deixei todos os valores por padr√£o e no final da p√°gina basta clicar em Generate token.\n\n\n\nLogo ap√≥s, aparecera o token, o qual voc√™ precisa copiar (click no icone azul bem do lado do token). Esse token ser√° necess√°rio para terminar a configura√ß√£o do Git com o Rstudio.\n\n\n\nAgora escreva\n\n\nusethis::edit_r_environ()\n\n\n\nO Rstudio abrir√° um arquivo chamado .Renviron, nele escreva o token que acabou de ser gerado e depois d√™ um enter (para pular linha).\n\n\n\nSalve o arquivo e reinicie sess√£o (se preferir pode fechar o Rstudio e abri-lo de novo)\n\n\n.rs.restartR()\n\n\n\n\nPronto! Agora j√° est√° configurado.\n\nVinculando um reposit√≥rio ao Rstudio\nA forma mais f√°cil de trabalhar com um projeto no Rstudio e que este esteja vinculado ao GitHub √© clonando um repos√≠torio existente. Para isto, precisamos primeiro criar um reposit√≥rio no GitHub e depois clon√°-lo.\nCriando o reposit√≥rio no GitHUb\nNo GitHub, v√° na aba Repositories e d√™ clic em New\n\n\n\nAparecer√° a janela abaixo e voc√™ pode escolher se criar um reposit√≥rio p√∫blico ou privado e se adicionar um README ou nao. Aqui, eu escolhi a op√ß√£o privado e adicionar README. Ap√≥s escolher as op√ß√µes da sua prefer√™cia clic em Create repository.\n\n\n\nCom o reposit√≥rio criado, d√™ um clic na setinha do bot√£o Code e copie o endere√ßo que aparecer.\n\n\n\nClonando o repositorio.\nAgora estamos chegando na etapa final. Abra o Rstudio e crie um novo projeto File > New Project... e escolha a op√ß√£o Version Control.\n\n\n\nEnseguida escolha a op√ß√£o Git e preencha a op√ß√£o Repository URL com o endere√ßo que acabou de copiar do GitHub. Escolha tamb√©m onde quer criar o projeto no seu computador (no meu caso /Volumes/CTRUCIOS_SD/Research). N√£o esque√ßa marcar a op√ß√£o Open in new session.\n\n\n\n\n\n\nClicar em Create project e Pronto! Seu reposit√≥rio no GitHub e seu novo projeto do Rstudio est√£o vinculados, agora √© s√≥ escrever seus c√≥digos e fazer commits, Push and Pulls.\nBonus: commit and push\nO c√≥digo que voc√™ escrever√° no seu computador, ficar√° unicamente no seu computador. Por isso, n√£o esque√ßa fazer commit e Push de tempos em tempos para salvar no GitHub seu c√≥digo mais recente.\nPara mostrar como se fazer commit and Push, criei um arquivo chamado codigo01.R\n\n\n\nPara fazer commit, v√° na aba Git e d√™ clic na op√ß√£o Commit.\n\n\n\nAgora marque os arquivos que quer subir para o GitHub (no nosso caso, o arquivo codigo01.R) e escreva uma breve descri√ß√£o do que foi feito no c√≥digo (para voc√™ lembrar).\n\n\n\nClic em Commit e depois clic em Push.\nSe tudo deu certo, seu c√≥digo aparecer√° no seu reposit√≥rio do GitHub.\n\n\n\nNota: Se o arquivo codigo01.R n√£o aparecer no GitHub, tente fazer um Push de novo, se lhe pedir usuario e senha, coloque seu nome de usu√°rio do GitHub e quando pedir a senha coloque o token que foi gerado (no come√ßo deste post).\n\n\n\nEDIT:\nCaso Rstudio pe√ßa seu usu√°rio e senha constantemente, tente com a fun√ß√£o gitcreds_set() do pacote gitcreds.\n\n\ngitcreds::gitcreds_set()\n\n\n\nAp√≥s rodar o comando, basta seguir os passos e inserir seu token.\nEspero ter ajudado. Happy Coding!\n\n\n\n",
    "preview": "posts/2021-06-12-git-github-e-rstudio/im/001.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 1340,
    "preview_height": 688
  },
  {
    "path": "posts/2021-05-01-configurando-rstudio-para-usar-o-rmarkdown/",
    "title": "Configurando Rstudio para usar o Rmarkdown",
    "description": "Passo a passo de como configurar o Rstudio para fazer relat√≥rios e apresenta√ß√µes utlizando o Rmarkdown.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-05-01",
    "categories": [
      "Rstudio",
      "Rmarkdown",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nPasso a Passo\nConclus√µes\n\nIntrodu√ß√£o\nFazer relat√≥rios t√©cnicos, apresenta√ß√µes e escrever artigos √© parte do dia a dia tanto das pessoas envolvidas com pesquisa quanto das envolvidas com an√°lise de dados.\nFazer estas tarefas pode ser cansativo e, incluss√≠ve, levar a erros na digita√ß√£o dos resultados.\nUma forma eficiente e f√°cil de fazermos isto √© misturar a funcionalidade do R com a versatilidade de fazer relat√≥rios utilizando o Rmarkdown.\nA seguir, descreverei passo a passo como configurar o Rstudio para poder fazer apresenta√ß√µes/relat√≥rios utilizando o Rmarkdown1.\nPasso a Passo\nSe √© a primeira vez que est√° tentando fazer um relat√≥rio/apresenta√ß√£o e est√° em d√∫vida sobre como proseguir, segue um passo e passo detalhado\nPasso 1\nQuando abrir o Rstudio, ver√° uma tela semelhante com essa aqui:\n\n\n\nPasso 2\nCrie um script markdown:\n\nFile > New File > R Markdown\n\n\n\n\nAssim que criar o script aparecer√° a seguinte mensagem\n\n\n\nbasta clicar em Yes e deixar que todos os pacotes sejam instalados (voc√™ ver√° algo como a tela a seguir).\n\n\n\nPasso 3\nAp√≥s instalar todos os pacotes, tente mais uma vez criar o script\n\nFile > New File > R Markdown\n\nPor padr√£o, a op√ß√£o Document estar√° ativa e se tudo estiver certo, voc√™ ver√° na tela o seguinte:\n\n\n\nse voc√™ escolher a op√ß√£o Presentation, ver√° a seguinte:\n\n\n\nEm ambas as op√ß√µes voc√™ pode escolher como far√° o relat√≥rio/apresenta√ß√£o (html, pdf ou word/power point). Escolha a op√ß√£o PDF ou PDF (Beamer)2\nPasso 4\nIndependente da op√ß√£o escolhida (Document ou Presentation) aparecer√° um template pronto para rodar. Basta voc√™ clicar no bot√£o Knit\n\n\n\n(esse bot√£o √© para compilar tudo o escrito no seu relat√≥rio/apresenta√ß√£o e utilizar√° ele frequentemente)\nSe voc√™ for usu√°rio de Latex, j√° deve ter o miktex instalado e o Rmarkdown deveria funcionar normalmente. Caso n√£o seja usu√°rio de Latex, continue com os pr√≥ximos passos.\nPasso 5\nQuando apertar o bot√£o pela primeira vez, caso voc√™ n√£o tenha instalado antes o miktex, o arquivo n√£o compilar√° e aparecer√° algo parecido com:\n\n\n\nO que importa para n√≥s √© a seguinte mensagem:\n\n\n\nOu seja, precisamos instalar mais algumas coisinhas antes de podermos fazer apresenta√ß√µes/relat√≥rios utilizando o Rstudio.\nBasta rodar o comando\n\n\ntinytex::install_tinytex()\n\n\n\nque tudo o necess√°rio ser√° instalado (voc√™ ver√° uma janela como a seguinte)\n\n\n\nPasso 6\nAssim que a instala√ß√£o anterior tiver terminado, aparecer√° a seguinte mensagem\n\n\n\nmas n√£o se preocupe, apenas ignore.\nPasso 7\nPronto! j√° pode utilizar o Rstudio para fazer relat√≥rios. Para testar, aperte o bot√£o knit\n\n\n\ne o pdf de exemplo ser√° compilado!\n\n\n\nConclus√µes\nRstudio √© uma excelente IDE para se trabalhar com R, mas agora podemos al√©m de escrever nosso c√≥digo, fazer relat√≥rios/apresenta√ß√µes\nPara poder utilizar basta apenas seguir alguns passos simples de configura√ß√£o\nSe voc√™ j√° tiver instalado o Latex no seu computador, pode pular os passos 5 e 6, e ir direto para o passo 7\nCaso n√£o saiba o que √© Latex (isso significa que n√£o tem o Latex nem miktex instalados) n√£o se preocupe, basta seguir os passos 5 e 6 que tudo ficar√° pronto para utilizar o Rstudio para fazer relat√≥rios/apresenta√ß√µes\n\nOs passos s√£o bem intuitivos e a maioria de pessoas talvez n√£o precise deste tutorial, mas, caso algu√©m precisar, deixo aqui o passo a passo‚Ü©Ô∏é\nPode escolher qualquer outra op√ß√£o mas eu prefiro fazer em PDF. Ah, eu nunca testei a op√ß√£o word/power point mas deveria funcionar‚Ü©Ô∏é\n",
    "preview": "posts/2021-05-01-configurando-rstudio-para-usar-o-rmarkdown/im/001.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 1366,
    "preview_height": 768
  },
  {
    "path": "posts/2021-04-01-minimos-quadrados-ordinarios/",
    "title": "M√≠nimos Quadrados Ordin√°rios",
    "description": "Quando trabalhamos com modelos de regress√£o √© necess√°rio estimar os par√¢metros do modelo. Um dos m√©todos de estima√ß√£o mais conhecidos √© o estimador de m√≠nimos quadrados ordin√°rios (ou MQO para os amigos). Em este post discutiremos a necessidade de estimar os par√¢metros, entendermos a intui√ß√£o por tr√°s do m√©todo e derivaremos, passo a passo, o estimador MQO no modelo de regress√£o linear simples.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-04-01",
    "categories": [
      "Linear Regression",
      "Proof"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nA intui√ß√£o por tr√°s do estimador MQO\nDerivando o estimador MQO\nPrimeira derivada\nIgualando a zero\nVerificando que √© ponto de m√≠nimo\nEstimador MQO\n\nConclus√µes\n\nIntrodu√ß√£o\nO modelo de regress√£o linear simples √© um dos modelos mais simples de Statistical Learning / Econometria. O modelo assume que a rela√ß√£o entre as vari√°veis \\(Y\\) e \\(X\\) √© dada por: \\[\\begin{equation}\\label{RLS}\nY = \\beta_0 + \\beta_1 X + u\n\\end{equation}\\] em que \\(\\beta_0\\) e \\(\\beta_1\\) s√£o os par√¢metros do modelo e \\(u\\) √© um termo aleat√≥rio.\nSe conhecermos \\(\\beta_0\\) e \\(\\beta_1\\), basta utilizar o modelo para um determinado valor de \\(X\\), digamos \\(x\\), e saberemos o valor esperado de \\(Y\\) dado \\(x\\)1.\nInfelizmente, nunca conhecemos \\(\\beta_0\\) e \\(\\beta_1\\) e ent√£o precisamos estimar esses valores utilizando os dados da nossa amostra.\nExistem v√°rios m√©todos de estima√ß√£o, mas hoje discutiremos o estimador de m√≠nimos quadrados ordin√°rios (MQO).\nA intui√ß√£o por tr√°s do estimador MQO\nSejam \\((y_1, x_1), \\ldots, (y_n, x_n)\\) os elementos de uma amostra aleaat√≥ria (a.a) de tamanho \\(n\\) extraida de \\((Y,X)\\). Estamos interessados em estimar os par√¢metros \\(\\beta_0\\) e \\(\\beta_1\\) na reta de regress√£o, mas‚Ä¶qual reta escolher?\nA Figura 1 apresenta o gr√°fico de dispers√£o de educa√ß√£o (\\(x\\)) vs.¬†renda (\\(y\\)). Como podemos ver, existem v√°rias retas (na verdade existem infinitas retas) que podemos tracejar na nossa tentativa de estimar \\(\\beta_0\\) e \\(\\beta_1\\).\n\n\n\nFigure 1: Gr√°fico de dispers√£o education vs.¬†income\n\n\n\nEntre os v√°rios crit√©rios que poder√≠amos escolher para escolher a reta, vamos escolher a reta que minimiza a soma de quadrados dos res√≠duos. Mas‚Ä¶ quem s√£o esses res√≠duos? os res√≠duos, denotados por \\(\\hat{u}_i\\), s√£o definidos como \\(\\hat{u}_i = y_i - \\hat{y_i}\\) com \\(\\hat{y}_i = b_0 + b_1x_i\\). Ou seja, independente dos valores \\(b_0\\) e \\(b_1\\) que escolhermos, os res√≠duos s√£o a diferen√ßa entre o valor verdadeiro (\\(y_i\\)) e o estimado (\\(\\hat{y}_i\\)).\nOs valores \\(b_0\\) e \\(b_1\\) que minimizem a SQR vamos denot√°-los como \\(\\hat{\\beta}_0\\) e \\(\\hat{\\beta}_1\\). Em termos matem√°ticos, queremos \\(b_0\\) e \\(b_1\\) tal que \\[\\hat{\\beta}_0, \\hat{\\beta}_1 = \\mathop{\\mathrm{argmin}}\\limits_{b_0, b_1} SQR\\] em que \\[SQR := \\displaystyle \\sum_{i=1}^n \\hat{u}_i^2 \\equiv \\displaystyle \\sum_{i=1}^n (y_i - \\hat{y}_i)^2 \\equiv \\displaystyle \\sum_{i=1}^n (y_i - b_0 - b_1 x_i)^2\\]\nDerivando o estimador MQO\nNosso problema de encontrar \\(\\hat{\\beta}_0\\) e \\(\\hat{\\beta}_1\\) resume-se, ent√£o, a um problema de minimiza√ß√£o, onde a fun√ß√£o a minimizar √© \\[SQR := \\displaystyle \\sum_{i=1}^n (\\underbrace{y_i - b_0 - b_1 x_i}_{\\hat{u}_i})^2\\]\nPara resolver nosso problema de minimiza√ß√£o vamos a lembrar um pouco das aulas de c√°lculo. Vamos a calcular a primeira derivada, igualar a zero para obter os valores candidatos e finalmente, vamos a calcular a segunda derivada para verificar que efetivamente os valores encontrados s√£o valores que minimizam a fun√ß√£o.\nPrimeira derivada\nDerivando SQR em rela√ß√£o a \\(b_0\\) temos\n\\[\\begin{equation}\n\\dfrac{\\partial SQR}{\\partial b_0}   = -2 \\displaystyle \\sum_{i=1}^n (y_i - b_0 - b_1 x_i)  = -2 n \\big( \\bar{y} - b_0 - b_1 \\bar{x} \\big).\n\\end{equation}\\]\nDerivando SQR em rela√ß√£o a \\(b_1\\) temos\n\\[\\begin{equation}\n\\dfrac{\\partial SQR}{\\partial b_1}= -2 \\displaystyle \\sum_{i=1}^n x_i (y_i - b_0 - b_1 x_i) = -2  \\Big( \\displaystyle \\sum_{i=1}^n x_i y_i - b_0 \\displaystyle \\sum_{i=1}^n x_i - b_1 \\displaystyle \\sum_{i=1}^n x_i^2 \\Big).\n\\end{equation}\\]\nIgualando a zero\nFazendo \\(\\frac{\\partial SQR}{\\partial b_0} = 0\\) e \\(\\frac{\\partial SQR}{\\partial b_1} = 0\\) temos:\n\\[\\underbrace{\\bar{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 \\bar{x}}_{A} \\quad e \\quad \\underbrace{\\displaystyle \\sum_{i=1}^n x_i (y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 x_i) = 0}_{B}\\]\n\nQuando igualamos a zero, substituimos \\(b_0\\) por \\(\\hat{\\beta}_0\\) e \\(b_1\\) por \\(\\hat{\\beta}_1\\) pois \\(\\hat{\\beta}_0\\) e \\(\\hat{\\beta}_1\\) s√£o a solu√ß√£o do sistema.\nVamos ent√£o resolver o sistema de equa√ß√µes para obter \\(\\hat{\\beta}_0\\) e \\(\\hat{\\beta}_1\\).\nDe \\(A\\) temos que \\(\\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}\\). Agora vamos substituir \\(\\hat{\\beta}_0\\) em \\(B\\),\n\\[\\displaystyle \\sum_{i=1}^n x_i (y_i - \\underbrace{(\\bar{y} - \\hat{\\beta}_1 \\bar{x})}_{\\hat{\\beta}_0} - \\hat{\\beta}_1 x_i) = 0\\] \\[\\displaystyle \\sum_{i=1}^n x_i(y_i-\\bar{y}) - \\hat{\\beta}_1 \\sum_{i=1}^n x_i (x_i - \\bar{x}) = 0\\]\n\\[\\displaystyle \\sum_{i=1}^n x_i(y_i-\\bar{y}) = \\hat{\\beta}_1 \\sum_{i=1}^n x_i (x_i - \\bar{x}),\\] Ent√£o, \\[\\hat{\\beta}_1 = \\dfrac{\\displaystyle \\sum_{i=1}^n x_i(y_i-\\bar{y})}{\\displaystyle \\sum_{i=1}^n x_i (x_i - \\bar{x})}.\\] Provavelmente, a f√≥rmula n√£o se parece muito com as f√≥rmulas que voc√™ est√° acostumado a ver nos livros. Vamos trabalhar um pouco com as express√µes no numerador e denominador para chegarmos a uma f√≥rmula um pouco mais conhecida.\nNo denominador:\n\\[\\displaystyle \\sum_{i=1}^n x_i (x_i-\\bar{x}) = \\sum_{i=1}^n (x_i - \\bar{x} + \\bar{x})(x_i-\\bar{x}) = \\underbrace{\\sum_{i=1}^n (x_i - \\bar{x})(x_i-\\bar{x})}_{\\displaystyle \\sum_{i=1}^n (x_i - \\bar{x})^2} + \\underbrace{\\sum_{i=1}^n  \\bar{x}(x_i-\\bar{x})}_{\\bar{x} \\displaystyle \\sum_{i=1}^n  (x_i-\\bar{x})},\\] e como \\(\\displaystyle \\sum_{i=1}^n (x_i - \\bar{x}) = \\underbrace{\\sum_{i=1}^n x_i}_{n\\bar{x}} - n \\bar{x} = 0,\\) temos que \\[\\displaystyle \\sum_{i=1}^n x_i (x_i-\\bar{x}) = \\displaystyle \\sum_{i=1}^n (x_i-\\bar{x})^2.\\] No numerador:\n\\[\\displaystyle \\sum_{i=1}^n x_i(y_i-\\bar{y}) = \\displaystyle \\sum_{i=1}^n (x_i - \\bar{x} + \\bar{x})(y_i-\\bar{y}) = \\displaystyle \\sum_{i=1}^n (x_i - \\bar{x})(y_i-\\bar{y}) + \\underbrace{\\displaystyle \\sum_{i=1}^n \\bar{x}(y_i-\\bar{y})}_{\\bar{x} \\underbrace{\\displaystyle \\sum_{i=1}^n (y_i-\\bar{y})}_{0}}\\] Ent√£o temos que, \\[\\hat{\\beta}_1 = \\dfrac{\\displaystyle \\sum_{i=1}^n (x_i - \\bar{x})(y_i-\\bar{y})}{\\displaystyle \\sum_{i=1}^n (x_i-\\bar{x})^2} \\quad e \\quad \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}.\\]\nVerificando que √© ponto de m√≠nimo\nPara verificar que a solu√ß√£o obtida √© ponto de m√≠nimo, precisamos que a matriz Hessiana \\[\\begin{bmatrix} \n\\dfrac{\\partial^2 SQR}{\\partial b_0^2} & \\dfrac{\\partial^2 SQR}{\\partial b_0 \\partial b_1}  \\\\\n\\dfrac{\\partial^2 SQR}{\\partial b_1 \\partial b_0} & \\dfrac{\\partial^2 SQR}{\\partial b_1^2}  \\\\\n\\end{bmatrix}\\] seja definida positiva.\n\\(\\dfrac{\\partial^2 SQR}{\\partial b_0^2} = \\dfrac{\\partial}{\\partial b_0}\\dfrac{\\partial SQR}{\\partial b_0} = 2n\\)\n\\(\\dfrac{\\partial^2 SQR}{\\partial b_0 \\partial b_1} = \\dfrac{\\partial}{\\partial b_0}\\dfrac{\\partial SQR}{\\partial b_1} = 2n \\bar{x}\\)\n\\(\\dfrac{\\partial^2 SQR}{\\partial b_1 \\partial b_0} = \\dfrac{\\partial}{\\partial b_1}\\dfrac{\\partial SQR}{\\partial b_0} = 2n \\bar{x}\\)\n\\(\\dfrac{\\partial^2 SQR}{\\partial b_1^2} = \\dfrac{\\partial}{\\partial b_1}\\dfrac{\\partial SQR}{\\partial b_1} = 2 \\displaystyle \\sum_{i=1}^n x_i^2\\)\nLogo, a matriz Hessiana \\[\\begin{bmatrix} \n2n & 2n \\bar{x} \\\\\n2n \\bar{x} & 2 \\displaystyle \\sum_{i=1}^n x_i^2  \\\\\n\\end{bmatrix},\\] √© definida positiva pois os elementos da diagonal s√£o positivos e o determinante \\(4n\\displaystyle \\sum_{i=1}^n x_i^2 - 4n^2\\bar{x}^2 = 4n \\Big( \\sum_{i=1}^n x_i^2 - n\\bar{x}^2\\Big) = 4n \\displaystyle \\sum_{i=1}^n(x_i - \\bar{x})^2\\) √© tamb√©m positivo.\nEstimador MQO\nAssim, temos mostrado que os estimadores MQO para \\(\\beta_0\\) e \\(\\beta_1\\) no modelo de regress√£o linear simples s√£o \\[\\hat{\\beta}_1 = \\dfrac{\\displaystyle \\sum_{i=1}^n (x_i - \\bar{x})(y_i-\\bar{y})}{\\displaystyle \\sum_{i=1}^n (x_i-\\bar{x})^2} \\quad e \\quad \\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}.\\]\nConclus√µes\nO estimador MQO consiste em encontrar \\(\\hat{\\beta}_0\\) e \\(\\hat{\\beta}_1\\) que minimizm a soma de quadrados dos res√≠duos.\nUtilizando os crit√©rios da primeira e segunda derivada temos obtido os estimadore MQO.\nSob algumas hip√≥teses, os estimadores MQO s√£o o melhor estimador linear n√£o viesado ver Teorem de Gauss-Markov\nSe quiser saber como implementar este modelo em R e Python pode ver este post.\n\nAssumindo que \\(\\mathbb{E}(u|X) = 0\\), \\(\\mathbb{E}(Y|x) = \\beta_0 + \\beta_1 x\\)‚Ü©Ô∏é\n",
    "preview": "posts/2021-04-01-minimos-quadrados-ordinarios/derivando-o-estimador-de-mqo_files/figure-html5/MQO1-1.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "posts/2021-03-14-book-review-r-for-data-science/",
    "title": "Book Review: R for Data Science",
    "description": "Minhas impress√µes do livro R for data science: import, tidy, transform, visualize, and model data do Hadley Wickham e Garrett Grolemund.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-03-14",
    "categories": [
      "Book Review",
      "R",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nOverview do livro\nO que menos gostei\nComent√°rios Finais\n\nIntrodu√ß√£o\nQuem me conhece um pouco, sabe que eu n√£o sou um grande f√£ de livros do tipo Hands-On blah blah, mas recentemente, buscando ajudar aos meus alunos na sua caminhada acad√™mica, resolvi incluir alguns deles na minha lista de leitura. Espero que estes coment√°rios sejam de ajuda, principalmente, para meus (ex-/atuais/futuros) alunos.\nOverview do livro\n\n\n\n\n\nR tem evolu√≠do bastante desde que foi oficialmente lan√ßado em 2001 e o livro R for data science: import, tidy, transform, visualize, and model data (Wickham and Grolemund 2016) faz um bom papel apresentando uma introdu√ß√£o ao R e √† filosofia tidyverse1 de forma clara e direta. O pacote (ou, na verdade o conjunto de pacotes) tidyverse √© sem d√∫vida a tend√™ncia hoje em dia, e qualquer pessoa que trabalha com dados o utilizar√° com frequ√™ncia.\nSugiro que √† medida que voc√™ for lendo o livro implemente os c√≥digos que forem aparecendo, dessa forma voc√™ poder√° ir mexendo gradualmente no c√≥digo para ver o que acontece se‚Ä¶ o que lhe ajudara no processo de aprendizagem.\nUm dos cap√≠tulos que mais gostei foi o cap√≠tulo 3, que apresenta de forma bem leve uma introdu√ß√£o ao pacote ggplot2 para visualiza√ß√£o de dados. Um bom complemento para esse cap√≠tulo aparece quase no final do livro, no cap√≠tulo 28, onde se apresentam alguns detalhes sobre t√≠tulos, captions e nomes nos eixos. Se voc√™ tiver interesse em se aprofundar no ggplot2, a melhor fonte √© o livro ggplot2: Elegant Graphics for Data Analysis (Hadley 2016) que est√° dispon√≠vel online e de gra√ßa aqui.\nOs cap√≠tulos 9 ‚Äì 16 apresentam bastante material sobre manipula√ß√£o de dados, super √∫til para construir nossa ABT2. Contudo, creio que quem n√£o est√° muito acostumado com o R ou com manipula√ß√£o de dados pode ter uma overdose de informa√ß√£o. N√£o se preocupe tanto por entender tudo que est√° no livro, mas por entender o que pode ser feito com o R e com os pacotes dplyr,readr, lubridate, etc, incluidos no tidyverse. Existem diversos Cheatsheets que ajudam a lembrar como cada umas das fun√ß√µes discutidos nos cap√≠tos 9‚Äì16 funcionam, salve eles no computador e tenha-os sempre por perto.\nOutro cap√≠tulo que achei muito interessante √© o cap√≠tulo 25 (mas para quem est√° iniciando eu recomendaria pular esse capitulo e voltar nele quando for um usu√°rio de R mais frequente), ele apresenta informa√ß√£o valiosa para quem tem interesse em comparar v√°rios modelos e colocar modelos em produ√ß√£o.\nO que menos gostei\nEmbora eu tenha desfrutado bastante meu tempo lendo o livro, achei os cap√≠tulos 22‚Äì24 meio confussos, principalmente para quem est√° iniciando. Quando se trata de modelagem , eu prefiro uma abordagem mais cl√°ssica onde se explica como o modelo √© construido e quais s√£o os princ√≠pios por tras dele, mas entendo que isso est√° completamente fora do escopo do livro.\nPara quem est√° come√ßando, eu leria o cap√≠tulo 21 apenas at√© a se√ß√£o 21.3. As se√ß√µes 21.4 ‚Äì 21.9 s√£o importantes, mas eu deixaria elas para uma segunda leitura ou para quando estiver mais familiarizado com o R e com programa√ß√£o.\nComent√°rios Finais\nResumindo, R for data science: import, tidy, transform, visualize, and model data (Wickham and Grolemund 2016) √© um bom livro, completo e did√°tico. Eu gostei da maioria de cap√≠tulos, com algumas poucas exce√ß√µes.\nO livro tem uma vers√£o em portugu√™s, mas eu li a vers√£o em ingl√™s (que √© disponibilizada gratuitamente pelos autores).\nSe tiver com dificuldade em resolver os exerc√≠cios do livro, Jeffrey B. Arnold providenciou um solucion√°rio (eu n√£o o li).\n\n\n\nHadley, Wickham. 2016. ggplot2: Elegrant Graphics for Data Analysis. Springer.\n\n\nWickham, Hadley, and Garrett Grolemund. 2016. R for Data Science: Import, Tidy, Transform, Visualize, and Model Data. \" O‚ÄôReilly Media, Inc.\".\n\n\nConjunto de pacotes que seguem a mesma filosofia tidy, para mais detalhes veja tidyverse.org‚Ü©Ô∏é\nABT: Analytical Base Table‚Ü©Ô∏é\n",
    "preview": "posts/2021-03-14-book-review-r-for-data-science/cover.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 500,
    "preview_height": 750
  },
  {
    "path": "posts/2021-02-28-teorema-de-gauss-markov/",
    "title": "Teorema de Gauss-Markov",
    "description": "Uma das propriedades mais interessentes dos estimadores MQO √© fornecida pelo Teorema de Gauss-Markov. Neste post discutimos a import√¢ncia, significado e fornecemos uma demostra√ß√£o passo a passo do Teorema.",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-02-28",
    "categories": [
      "Linear Regression",
      "Proof"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nTeorema\nDemostra√ß√£o\nConclus√£o\n\nIntrodu√ß√£o\n\n\n\nO estimador de m√≠nimos quadrados ordin√°rios (MQO) √© um dos m√©todos de estima√ß√£o mais utilizados quanto √† analise de regress√£o se refere. Ele √© atrativo pela sua simplicidade e boas propriedades.\nSejam \\(\\{(y_i, x_{i,1}, \\ldots, x_{i,k}) \\}_{i=1, \\ldots, n}\\) tais que:\n\\[\\begin{align}\n\\begin{split}\\label{eq:1}\n    y_1 &= \\beta_0 + \\beta_1 x_{1,1}  + \\cdots + \\beta_k x_{1,k} + u_1 \\\\\n    \\vdots \\\\\n    y_n &= \\beta_0 + \\beta_1 x_{n,1}  + \\cdots + \\beta_k x_{n,k} + u_n \\\\\n\\end{split}\n\\end{align}\\]\nou equivalentemente\n\\[ \\underbrace{\\left[ \\begin{array}{c} y_1 \\\\ \\vdots \\\\ y_n \\end{array} \\right]}_{Y} = \\underbrace{\\begin{bmatrix} \n1 & x_{1,1} & \\cdots & x_{1,k} \\\\ \n\\vdots & \\vdots & \\cdots & \\vdots \\\\ \n1 & x_{n,1} & \\cdots & x_{n,k} \\end{bmatrix}}_{X} \\times \\underbrace{\\left[ \\begin{array}{c} \\beta_0 \\\\ \\vdots \\\\ \\beta_k \\end{array} \\right]}_{\\beta} + \\underbrace{\\left[ \\begin{array}{c} u_1 \\\\ \\vdots \\\\ u_n \\end{array} \\right]}_{u}\\]\nent√£o, o estimador MQO de \\(\\beta\\) √© dado por \\(\\hat{\\beta} = (X'X)^{-1}X'Y\\).\nSob certas condi√ß√µes, o Teorema de Gauss-Markov nos diz que \\(\\hat{\\beta}\\) √© o melhor estimador linear n√£o viesado (BLUE em Ingl√™s):\nEle √© linear1 pois \\(\\hat{\\beta} = (X'X)^{-1}X'Y\\) (basta fazer \\(A' = (X'X)^{-1}X'\\)).\nEle √© n√£o viesado pois \\(\\mathbb{E}(\\hat{\\beta}) = \\beta\\) e\nEle √© o melhor, pois possui a menor vari√¢ncia entre todos os outros estimadores lineares n√£o viesados.\nTeorema\nSeja \\(Y = X \\beta + u\\) com \\(X\\) de posto completo, \\(\\mathbb{E}(u|X) = 0\\) e \\(\\mathbb{V}(u|X) = \\sigma^2 I\\). Ent√£o \\(\\hat{\\beta}\\), o estimador MQO de \\(\\beta\\), √© o melhor estimador linear n√£o viesado (BLUE) de \\(\\beta\\).\nNote que o Teorema requer que:\nO modelo populacional seja da forma \\(Y = X \\beta + u\\)\n\\(X\\) seja de posto completo (ou seja n√£o existe colineariedade perfeita)\n\\(\\mathbb{E}(u|X) = 0\\)\n\\(\\mathbb{V}(u|X) = \\sigma^2 I\\)\nEssas condi√ß√µes s√£o √†s vezes conhecidas como as hip√≥teses de Gauss‚ÄìMarkov. Se alguma das hip√≥teses de Gauss‚ÄìMarkov n√£o for valida, ent√£o \\(\\hat{\\beta}\\) n√£o ser√° mais BLUE.\n\nOu seja Teorema de Gauss-Markov nos diz que se as condi√ß√µes do Teorema forem satisfeitas, n√£o adianta buscar por algum outro estimador linear n√£o viesado, pois \\(\\hat{\\beta}\\) ser√° o melhor (de menor vari√¢ncia).\n\nDemostra√ß√£o\nSeja \\(\\tilde{\\beta}\\) qualquer outro estimador linear n√£o viesado de \\(\\beta\\).\nComo \\(\\tilde{\\beta}\\) √© um estimador linear, ele √© da forma \\(\\tilde{\\beta} = A'Y\\) (para qualquer matriz \\(A\\) de dimens√£o \\(n \\times k+1\\) fun√ß√£o de \\(X\\).).\nComo \\(\\tilde{\\beta}\\) √© n√£o viesado, temos que \\(A'X = I\\) pois \\[\\begin{equation}\n\\begin{aligned}\n\\mathbb{E}(\\tilde{\\beta} | X)  & =  \\mathbb{E}(A'Y | X)\\\\\n                   & =  \\mathbb{E}(A' (X\\beta + u) | X) \\\\\n                   & =  \\mathbb{E}(A'X\\beta|X) + \\mathbb{E}(u|X) \\\\\n                   & =  \\mathbb{E}(A'X\\beta|X) \\quad \\text{pois } \\mathbb{E}(u|X) = 0 \\\\\n                   & =  A'X \\beta, \n\\end{aligned}\n\\end{equation}\\] que √© n√£o viesado se e somente se \\(A'X = I\\)\nA vari√¢ncia de \\(\\tilde{\\beta}\\) (condicional em \\(X\\)) √© \\[\\begin{equation}\n\\begin{aligned}\n\\mathbb{V}(\\tilde{\\beta}|X) & =  \\mathbb{V}(A'Y|X) \\\\\n                & =  A'\\mathbb{V}(Y|X)A \\\\\n                & =  A'\\mathbb{V}(X \\beta + u|X)A \\\\\n                & =  A'\\mathbb{V}(u|X)A \\\\\n                & =  A'\\sigma^2 I A \\\\\n                & =  \\sigma^2 A'A \\\\\n\\end{aligned}\n\\end{equation}\\]\nDefinamos \\(C = A - X(X'X)^{-1}\\), ent√£o \\(X'C = \\underbrace{X'A}_{I}-\\underbrace{X'X(X'X)^{-1}}_{I} = 0\\)\nSabemos que \\(\\mathbb{V}(\\hat{\\beta}|X) = \\sigma^2 (X'X)^{-1}\\). Ent√£o basta provar que \\(\\mathbb{V}(\\tilde{\\beta}|X) - \\mathbb{V}(\\hat{\\beta}|X)\\) √© semi-definida positiva, ou seja \\[A'A-(X'X)^{-1} \\geq 0.\\] Para provar isto vejamos que \\[\\begin{equation}\n\\begin{aligned}\nA'A-(X'X)^{-1} & =  [C+X(X'X)^{-1}]'[C+X(X'X)^{-1}] -(X'X)^{-1} \\\\\n            & =  [C'+ (X'X)^{-1} X'] [C+X(X'X)^{-1}] -(X'X)^{-1} \\\\\n            & =  C'C +  \\underbrace{C' X}_{0}(X'X)^{-1} + (X'X)^{-1} \\underbrace{X'C}_{0} \\\\ &  + (X'X)^{-1} \\underbrace{X' X(X'X)^{-1}}_{I} -(X'X)^{-1}\\\\\n            & =  C'C + (X'X)^{-1} -(X'X)^{-1} \\\\\n            & =  C'C \\geq 0.\\\\\n\\end{aligned}\n\\end{equation}\\]\nCom isso temos provado que \\(A'A \\geq (X'X)^{-1}\\) ou equivalentemente, \\[\\underbrace{\\sigma^2 A'A}_{\\mathbb{V}(\\tilde{\\beta}|X)} \\geq \\underbrace{\\sigma^2 (X'X)^{-1}}_{\\mathbb{V}(\\hat{\\beta}|X)},\\] que √© o que queremos demostrar.\n\\(C'C\\) √© de fato semi-definida positiva, veja Teorema A.4 em (Hansen 2020) ou 10.10 em (Seber 2008).\nConclus√£o\nSob as hip√≥teses de Gauss-Markov, temos demostrado que o estimador de MQO, \\(\\hat{\\beta}\\), amplamente utilizado em an√°lise de regress√£o √© o melhor estimador linear n√£o viesdado. Isto significa que se as hip√≥teses de Gauss-Markov s√£o verificadas, n√£o conseguiremos um estimador linear que seja melhor (menor vari√¢ncia) do que \\(\\hat{\\beta}\\).\n\n\n\nHansen, Bruce E. 2020. Econometrics. Online version. Wisconsin.\n\n\nSeber, George AF. 2008. A Matrix Handbook for Statisticians. Vol. 15. John Wiley & Sons.\n\n\nUm estimador linear √© um estimador da forma \\(\\tilde{\\beta} = A'Y\\) para uma matriz \\(A\\) de dimens√£o \\(n \\times k+1\\) fun√ß√£o de \\(X\\).‚Ü©Ô∏é\n",
    "preview": {},
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-02-25-intro-regressao-linear/",
    "title": "Intro √† Regress√£o Linear",
    "description": "Uma breve introdu√ß√£o √† An√°lise de Regress√£o Linear: interpreta√ß√£o e implementa√ß√£o no R (e no Python).",
    "author": [
      {
        "name": "Carlos Truc√≠os",
        "url": "https://ctruciosm.github.io"
      }
    ],
    "date": "2021-02-25",
    "categories": [
      "Linear Regression",
      "R",
      "Python",
      "rstats"
    ],
    "contents": "\n\nContents\nIntrodu√ß√£o\nEstima√ß√£o por MQO\nImplementa√ß√£o no R\nInterpreta√ß√£o\nConclus√µes\nBonus\n\nIntrodu√ß√£o\nUma das t√©cnicas mais conhecidas e difundidas no mundo de statistical/machine learning √© a An√°lise de Regress√£o Linear (ARL). Ela √© √∫til quando estamos interessados em explicar/predizer a vari√°vel dependente \\(y\\) utilizando um conjunto de \\(k\\) variaveis explicativas \\(x_1, \\ldots, x_k\\).\nBasicamente, utilizamos as \\(k\\) vari√°veis explicativas para entender o comportamento de \\(y\\) e, num contexto de regress√£o linear, assumimos que a rela√ß√£o entre \\(y\\) e as \\(x\\)‚Äôs √© dada por uma fun√ß√£o linear da forma:\n\\[y = \\underbrace{\\beta_0 + \\beta_1 x_1 + \\ldots + \\beta_k x_k}_{f(x_1, \\ldots, x_k)} + u,\\] em que \\(u\\) √© o termo de erro.\nEstima√ß√£o por MQO\nNa pr√°tica, nunca conhecemos \\(\\beta = [\\beta_0, \\beta_1, \\ldots, \\beta_k]'\\) e temos que estima esses valores utilizando os dados. Existem diferentes m√©todos de estima√ß√£o, sendo o m√©todo de m√≠nimos quadraros ordin√°rios (MQO) um dos mais comumente utilizados1.\nO estimador de MQO √© dado por \\[\\hat{\\beta} = (X'X)^{-1}X'Y,\\] e sua respectiva matriz de covari√¢ncia (condicional em \\(X\\)) √© dada por \\[V(\\hat{\\beta}|X) = \\sigma^2(X'X)^{-1}\\] em que \\(Y = [y_1, \\ldots, y_n]'\\) e \\(X = \\begin{bmatrix} 1 & x_{1,1} & \\cdots & x_{1,k} \\\\ \\vdots & \\vdots & \\cdots & \\vdots \\\\ 1 & x_{n,1} & \\cdots & x_{n,k} \\end{bmatrix}\\)\n\\(\\sigma^2\\) nunca √© conhecido, ent√£o utilizamos \\(\\hat{\\sigma}^2 = \\dfrac{ \\sum_{i=1}^n \\hat{u}_i^2}{n-k-1}\\), que √© um estimador n√£o viesado de \\(\\sigma^2\\) (\\(E(\\hat{\\sigma}^2) = \\sigma^2\\)).\nAssim, na pr√°tica n√≥s sempre utilizamos \\(\\widehat{V}(\\hat{\\beta}|X) = \\hat{\\sigma}^2(X'X)^{-1}\\) no lugar de \\(V(\\hat{\\beta}|X)\\).\nO desvio padr√£o, geralmente reportados pelos softwares estat√≠sticos/econom√©tricos, √© a raiz quadrada dos elementos na diagonal de \\(\\widehat{V}(\\hat{\\beta}|X)\\).\nO Teorema de Gaus‚ÄìMarkov estabelece que, sob algumas hip√≥teses (conhecidas como as hip√≥teses de Gauss-Markov), \\(\\hat{\\beta}\\) √© o melhor estimador linear n√£o viesado (BLUE em ingl√™s: Best Linear Unbiased Estimator), ou seja, para qualquer outro estimador linear2 \\(\\tilde{\\beta}\\), \\[V(\\tilde{\\beta}|X) \\geq V(\\hat{\\beta}|X).\\]\nA Figura 1 mostra um exemplo de uma reta de regress√£o \\(\\hat{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x\\) obtida pelo m√©todo de MQO.\n\n\n\nFigure 1: OLS regression line example\n\n\n\nImplementa√ß√£o no R\nRealizar uma regress√£o linear no R n√£o √© dif√≠cil, para ver como faze-lo utilizaremos o conjunto de dados hprice1 dispon√≠vel no pacote wooldridge do R.\nSe assumirmos que o modelo populacional √© da forma \\[price = \\beta_0 + \\beta_1 bdrms + \\beta_2 lotsize +  \\beta_3 sqrft + \\beta_4 colonial + u,\\] utilizamos o seguintes comandos\n\n\nlibrary(wooldridge)\nmodelo = lm(price~bdrms+lotsize+sqrft+colonial, data = hprice1)\nmodelo\n\n\n\nCall:\nlm(formula = price ~ bdrms + lotsize + sqrft + colonial, data = hprice1)\n\nCoefficients:\n(Intercept)        bdrms      lotsize        sqrft     colonial  \n -24.126528    11.004292     0.002076     0.124237    13.715542  \n\nO output anterior apenas mostra os \\(\\hat{\\beta}\\)‚Äôs, um output mais completo, que inclui o desvio padr√£o dos \\(\\hat{\\beta}\\)‚Äôs, o teste T, teste F, \\(R^2\\) e p-valores pode ser facilmente obtido utilizando a fun√ß√£o summary( ).\n\n\nsummary(modelo)\n\n\n\nCall:\nlm(formula = price ~ bdrms + lotsize + sqrft + colonial, data = hprice1)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-122.268  -38.271   -6.545   28.210  218.040 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.413e+01  2.960e+01  -0.815  0.41741    \nbdrms        1.100e+01  9.515e+00   1.156  0.25080    \nlotsize      2.076e-03  6.427e-04   3.230  0.00177 ** \nsqrft        1.242e-01  1.334e-02   9.314 1.53e-14 ***\ncolonial     1.372e+01  1.464e+01   0.937  0.35146    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 59.88 on 83 degrees of freedom\nMultiple R-squared:  0.6758,    Adjusted R-squared:  0.6602 \nF-statistic: 43.25 on 4 and 83 DF,  p-value: < 2.2e-16\n\nInterpreta√ß√£o\nAntes de interpretar os resultados √© importante e necess√°rio conhecer os dados e saber quais as unidades de medida das nossas vari√°veis3.\nPara darmos uma olhada nos dados utilizaremos as fun√ß√µes select( ) e glimpse( ) do pacote dplyr.\n\n\nlibrary(dplyr)\nhprice1 %>% select(price, bdrms, lotsize, sqrft, colonial) %>% glimpse()\n\n\nRows: 88\nColumns: 5\n$ price    <dbl> 300.000, 370.000, 191.000, 195.000, 373.000, 466.27‚Ä¶\n$ bdrms    <int> 4, 3, 3, 3, 4, 5, 3, 3, 3, 3, 4, 5, 3, 3, 3, 4, 4, ‚Ä¶\n$ lotsize  <dbl> 6126, 9903, 5200, 4600, 6095, 8566, 9000, 6210, 600‚Ä¶\n$ sqrft    <int> 2438, 2076, 1374, 1448, 2514, 2754, 2067, 1731, 176‚Ä¶\n$ colonial <int> 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, ‚Ä¶\n\n\nO pacote dplyr √© utilizado para manipula√ß√£o de dados. A fun√ß√£o select( ) seleciona algumas das variaveis contidas em hprice1 e a fun√ß√£o glimpse ( ) nos permite ver rapidamente a estrutura dos dados.\nA descri√ß√£o das vari√°veis √© apresentada a seguir e ela pode ser obtida utilizando diretamente os comandos help(hprice1) ou ?hprice1.\nVari√°vel\nDescri√ß√£o\nprice\npre√ßo da casa (em milhares de d√≥lares)\nbdrms\nn√∫mero de quartos\nlotsize\ntamanho do lote da casa (em p√©s\\(^2\\))\nsqrft\ntamanho da casa (em p√©s\\(^2\\))\ncolonial\nDummy (=1 se a casa for de estilo colonial)\nConhecendo melhor os dados, vamos ent√£o interpretar os resultados:\n\\(\\approx 66\\%\\) da variabilidade do pre√ßo (price) √© explicada pelo nosso modelo4.\nUtilizando as estat√≠sticas T (\\(H_0: \\beta_i = 0 \\quad \\text{vs.} \\quad H_1: \\beta_i \\neq 0\\)) apenas lotsize e sqrft s√£o estat√≠sticamente significativas (i.e. rejeitamos \\(H_0\\)) ao n√≠vel de signific√¢ncia de 5%.\nO incremento em 481 p√©s\\(^2\\) (p√©s quadrados) no lote da casa, implica, em m√©dia, um incremento de mil d√≥lares5 no pre√ßo da casa (permanecendo fixos os outros fatores).\nO incremente em 8 p√©s\\(^2\\) no tamanho da casa, implica, em √©dia, um incremento de mil d√≥lares6 no pre√ßo da casa (permanecendo fixos os outros fatores).\nFinalmente, summary( ) tamb√©m fornece informa√ß√£o para testar conjuntamente \\[H_0: \\beta_{bdrms}=0,\\beta_{lotsize}=0,\\beta_{sqrft}=0,\\beta_{colonial}=0\\] vs.¬†\\[H_1: H_0 \\text{ is not true. }\\] Utilizando o teste F, rejeitamos \\(H_0\\) (p-valor \\(\\approx\\) 0, F-statistics = 43.25)\n\nObviamente, nossa interpreta√ß√£o foi realizada assumindo que as hip√≥teses do modelo linear cl√°ssico s√£o satisfeitas. Se as hip√≥teses n√£o s√£o satisfeitas, precisamos melhoras/corrigir nosso modelo e apenas interpretar os resultados quando as hip√≥teses do modelo linear cl√°ssico forem verificadas.\n\nNo livro do Wooldridge7 encontramos uma interessante discuss√£o sobre como interpretar os \\(\\beta\\)‚Äôs quando utilizamos ou n√£o transforma√ß√µes logaritmicas. A seguinte Tabela apresenta um resumo dessa discuss√£o e fornece uma guia para melhor interpretarmos os resultados\nVari√°vel dependente\nVari√°vel independente\nInterpreta√ß√£o do \\(\\beta\\)\n\\(y\\)\n\\(x\\)\n\\(\\Delta y = \\beta \\Delta x\\)\n\\(y\\)\n\\(\\log(x)\\)\n\\(\\Delta y = \\big(\\beta/100 \\big) \\% \\Delta x\\)\n\\(\\log(y)\\)\n\\(x\\)\n\\(\\% \\Delta y = 100\\beta \\Delta x\\)\n\\(\\log(y)\\)\n\\(\\log(x)\\)\n\\(\\% \\Delta y = \\beta \\% \\Delta x\\)\nConclus√µes\nARL √© um m√©todos estat√≠stico (econom√©trico, de machine/statiscal learning) poderoso e facil de implementar, ele pode fornecer insights importantes sobre nossos dados (e consequentemente sobre nosso neg√≥cio).\nR fornece uma forma facil de utilizar regress√£o linear e fornece tamb√©m informa√ß√£o √∫til para sua interpreta√ß√£o. Contudo, √© importante tomar cuidado sobre as hip√≥teses assumidas no modelo (que √© o t√≥pico do nosso pr√≥ximo post), a n√£o verifica√ß√£o das hip√≥teses pode ter um forte impacto nos resultados obtidos.\nBonus\nImplementa√ß√£o em Python\n\nimport statsmodels.api as sm\nimport pandas as pd\nfrom patsy import dmatrices\n\nurl = \"https://raw.githubusercontent.com/ctruciosm/statblog/master/datasets/hprice1.csv\"\nhprice1 = pd.read_csv(url)\n\ny, X = dmatrices('price ~ bdrms + lotsize + sqrft + colonial', \n                  data = hprice1, return_type = 'dataframe')\n# Definir o modelo\nmodelo = sm.OLS(y, X)\n# Ajustar (fit) o modelo\nmodelo_fit = modelo.fit()\n# Resultados completos do modelo\nprint(modelo_fit.summary())\n                            OLS Regression Results                            \n==============================================================================\nDep. Variable:                  price   R-squared:                       0.676\nModel:                            OLS   Adj. R-squared:                  0.660\nMethod:                 Least Squares   F-statistic:                     43.25\nDate:                S√°b, 24 Jul 2021   Prob (F-statistic):           1.45e-19\nTime:                        10:24:23   Log-Likelihood:                -482.41\nNo. Observations:                  88   AIC:                             974.8\nDf Residuals:                      83   BIC:                             987.2\nDf Model:                           4                                         \nCovariance Type:            nonrobust                                         \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nIntercept    -24.1265     29.603     -0.815      0.417     -83.007      34.754\nbdrms         11.0043      9.515      1.156      0.251      -7.921      29.930\nlotsize        0.0021      0.001      3.230      0.002       0.001       0.003\nsqrft          0.1242      0.013      9.314      0.000       0.098       0.151\ncolonial      13.7155     14.637      0.937      0.351     -15.397      42.828\n==============================================================================\nOmnibus:                       24.904   Durbin-Watson:                   2.117\nProb(Omnibus):                  0.000   Jarque-Bera (JB):               45.677\nSkew:                           1.091   Prob(JB):                     1.21e-10\nKurtosis:                       5.774   Cond. No.                     6.43e+04\n==============================================================================\n\nNotes:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n[2] The condition number is large, 6.43e+04. This might indicate that there are\nstrong multicollinearity or other numerical problems.\n\n\nA ideia b√°sica deste m√©todo √© encontrar os valores \\(\\hat{\\beta}\\)‚Äôs que minimizam a soma de quadrados dos residuos.‚Ü©Ô∏é\nUm estimador linear √© um estimador da forma \\(\\tilde{\\beta} = A'Y\\) em que a matrix \\(A\\) √© uma matriz de dimens√£o \\(n \\times k+1\\) fun√ß√£o de \\(X\\)‚Ü©Ô∏é\nNa pr√°tica, antes de ajustar a reta de regress√£o √© feita uma an√°lise explorat√≥ria de dados (EDA em ingl√™s). Nessa EDA j√° conheceremos melhor as vari√°veis com as que estamos trabalhando, bem como as unidades de medida.‚Ü©Ô∏é\nGeralmente, preferimos o \\(R^2_{Adjusted}\\) ao \\(R^2\\)‚Ü©Ô∏é\n\\(2.076e-03*481 = 0.998556 \\approx 1\\)‚Ü©Ô∏é\n\\(0.1242*8 = 0.9936 \\approx 1\\)‚Ü©Ô∏é\nWooldridge, J. M. (2016). Introdu√ß√£o √† Econometria: Uma abordagem moderna. Cengage.‚Ü©Ô∏é\n",
    "preview": "posts/2021-02-25-intro-regressao-linear/uma-introduo-regresso-linear_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2024-09-28T06:04:54+02:00",
    "input_file": {},
    "preview_width": 1536,
    "preview_height": 768
  }
]
